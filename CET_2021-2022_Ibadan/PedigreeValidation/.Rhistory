filter(!is.na(male.parent.accession)) %>%
filter(inf.male.name == male.parent.accession) %>%
filter(estSire < 50000) #also must pass a threshold
correct_top_matches <- sire_scores_top %>%
filter(!is.na(male.parent.accession))
head(correct_top_matches)
#Reload genotypes
geno.sum = readRDS("SNgenotypes_geno.sum.RDS")
#Read in pedigree:
pedigree = read.csv("../Data_backup/21.GS.C6.SN.Student2.IB_pedigree.csv")
pedigree[pedigree==""] <- NA #fill blanks with NA
##note: need to go through and manually add pedigree of individuals that were missing from original field layout
#Count number of all parents:
allparentlist = unique(c(pedigree$female.parent.accession, pedigree$male.parent.accession))
length(allparentlist)-1 #minus 1 for NA
#41 parents
#saveRDS(allparentlist[-42], file="allparentlist.RDS") #remove last NA
#Count number of families:
familylist = unique(str_match(pedigree$progeny.name, "F(.*?)P"))[,2] #extract family names
length(familylist)
#272 families
#Look up original intro status of parents:
grouped.parents = read.csv("~/Desktop/Research/Glaziovii_introgression/parent_list_grp.csv")
grouped.used.parents = unique(left_join(as.data.frame(allparentlist), grouped.parents[,1:2], by=c("allparentlist"="parent")))
#write.csv(grouped.used.parents, file="~/Desktop/Research/Glaziovii_introgression/parent_list_used_grouped.csv")
#there are 20 fully het parents, 20 with a recombination already
### Merge pedigree with genotype data:
#clean sample name to prepare for merge
geno.sum$accession = str_replace(geno.sum$SubjectID, "_A[0-9]*", "")
#merge
genos.ped = left_join(geno.sum, pedigree, by=c("accession" = "progeny.name"))
#Count number of families in genotype data:
genos.ped = genos.ped %>% rowwise %>%
mutate(family = paste(female.parent.accession, male.parent.accession, sep="_")) %>% as.data.frame()
length(unique(genos.ped$family)) #259 families represented in genotyped samples
#Count number of progeny from biparental families in genotype data:
nrow(genos.ped %>% subset(type == "biparental")) #1248 progeny from biparental crosses
nrow(genos.ped %>% subset(type == "open")) #1717 progeny from biparental crosses
#total 2965 progeny, the other 43 are parents + wild controls
#read in parental genotypes from the KASP validation:
parent.clusters = readRDS("~/Desktop/Research/Glaziovii_introgression/KASP_design/Verification_05-2021/parent.clusters.rds")
#exp.glaz.dose = readRDS("~/Desktop/Research/Glaziovii_introgression/KASP_design/Verification_05-2021/expected.glaz.dose.around.kasp.uplifted.keyed.parent-aggregated.rds")
#read in expected glaziovii dosage based on IDMs (Wolfe et al. 2019):
exp.glaz.dose = readRDS("~/Desktop/Research/Glaziovii_introgression/KASP_design/Verification_05-2021/parent.clusters.10kasp.RDS")
exp.glaz.dose$mean.glazdose = as.numeric(exp.glaz.dose$mean.glazdose)
#method 1: aggregate by mean glaz allele dosage at each marker
exp.glaz.dose.wide = aggregate(mean.glazdose ~ parent + kasp, mean, data=exp.glaz.dose) %>%
spread(kasp, mean.glazdose) #convert to wide format with spread
#method 2: aggregate by 'glaz.fac',
#a factor representing the best estimated allele dosage at each marker (rounded to 0, 1, or 2)
exp.glaz.dose$glaz.fac = as.numeric(exp.glaz.dose$glaz.fac)
exp.glaz.wide = aggregate(glaz.fac ~ parent + kasp, mean, data=exp.glaz.dose) %>%
spread(kasp, glaz.fac) #convert to wide format with spread to match genotype data format
head(kasps_ped)
head(parent.genos)
head(geno.sum)
#pull out parental genotypes:
parentlist = unique(c(geno.sum$female.parent.accession, geno.sum$male.parent.accession))
head(parentlist)
parentlist <- unique(c(geno.sum$female.parent.accession, geno.sum$male.parent.accession))
parentlist
geno.sum$female.parent.accession
head(geno.sum)
head(pedigree)
parentlist <- unique(c(pedigree$female.parent.accession, pedigree$male.parent.accession))
parent.genos = geno.sum[geno.sum$accession %in% parentlist,]
head(parent.genos)
tail(parent.genos)
i<- 2
hetparents = parent.genos[parent.genos[,i] == 1, 'accession']
hetparents
head(kasps_ped)
head(correct_top_matches)
kasps_ped <- geno.sum %>% mutate(progeny.name =
gsub(".*[...]", "", geno.sum$SubjectID)) %>%
left_join(correct_top_matches, by="progeny.name")
head(kasps_ped)
for(i in 2:11){
print(i)
#list parents that are hets at kasp i
hetparents = parent.genos[parent.genos[,i] == 1, 'accession']
#select progeny for which both parents are het at kasp i
segprogeny = kasps_ped[kasps_ped$female.parent.accession %in% hetparents
& kasps_ped$male.parent.accession %in% hetparents,]
N = nrow(segprogeny)
print(N)
}
i <- 2
hetparents = parent.genos[parent.genos[,i] == 1, 'accession']
hetparents
kasps_ped$female.parent.accession %in% hetparents
head(kasps_ped)
tail(kasps_ped$female.parent.accession)
head(geno.sum)
head(geno.sum %>% mutate(progeny.name =
gsub(".*[...]", "", geno.sum$SubjectID)))
tail(geno.sum %>% mutate(progeny.name =
gsub(".*[...]", "", geno.sum$SubjectID)))
tail(gsub(".*[_]", "", geno.sum$SubjectID))
tail(gsub("[_].*", "", geno.sum$SubjectID))
tail(geno.sum$SubjectID)
tail(gsub("_.*", "", geno.sum$SubjectID))
kasps_ped <- geno.sum %>% mutate(progeny.name =
gsub("_.*", "", geno.sum$SubjectID)) %>%
left_join(correct_top_matches, by="progeny.name")
tail(kasps_ped)
# merge with pedigree validation results
kasps_ped <- geno.sum %>% mutate(progeny.name =
gsub("_.*", "", geno.sum$SubjectID)) %>%
right_join(correct_top_matches, by="progeny.name")
head(kasps_ped)
nrow(kasps_ped)
head(correct_top_matches)
ped_top_rec <- ped_top %>%
mutate(progeny.name = sub(".*[...]", "", V1)) %>%
mutate(inf.male.name = sub(".*[...]", "", V2)) %>%
left_join(pedigree, by="progeny.name") %>%
rename(progeny.tag = V1) %>%
filter(chosen == 1)
head(ped_top)
head(pedigree)
head(ped_top)
nrow(ped_top)
tail(ped_top)
ped_top_rec <- ped_top %>%
mutate(progeny.name = sub(".*[...]", "", V1)) %>%
mutate(inf.male.name = sub(".*[...]", "", V2)) %>%
left_join(pedigree, by="progeny.name") %>%
rename(progeny.tag = V1)
head(ped_top_rec)
male_top_match <- ped_top_rec %>%
filter(!is.na(male.parent.accession)) %>%
filter(inf.male.name == male.parent.accession)
nrow(male_top_match)
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter( chosen == 1) %>%
mutate(inf.male.name = gsub(".*[...]", "", candidate)) %>%
left_join(ped_top_rec, by=c("id" = "progeny.tag"))
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter( chosen == 1) %>%
mutate(inf.male.name = gsub(".*[...]", "", candidate)) %>%
right_join(ped_top_rec, by=c("id" = "progeny.tag"))
head(sire_scores_top)
nrow(sire_scores_top)
head(sire_scores_top$inf.male.name.x, n=20)
head(sire_scores_top$inf.male.name.y, n=20)
sire_scores_top$inf.male.name.x == sire_scores_top$inf.male.name.y
tail(sire_scores_top$inf.male.name.y, n=20)
tail(sire_scores_top$inf.male.name.x, n=20)
tail(sire_scores$inf.male.name, n=20)
tail(sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter( chosen == 1) %>%
mutate(inf.male.name = gsub(".*[...]", "", candidate)))
nrow(sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter( chosen == 1) %>%
mutate(inf.male.name = gsub(".*[...]", "", candidate)))
nrow(sire_scores)
head(sire_scores)
nrow(sire_scores %>% filter(chosen == 1 ))
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter( chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
right_join(ped_top_rec, by=c("id" = "progeny.tag"))
nrow(sire_scores_top)
head(ped_top_rec)
tail(sire_scores$id)
tail(ped_top_rec$progeny.tag)
tail(sire_scores)
tail(sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1))
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
right_join(ped_top_rec, by=c("progeny.tag"= "id"))
head(ped_top_rec)
# look at distribution of sire scores for the top matches
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
left_join(ped_top_rec, by=c("progeny.tag"= "id"))
# look at distribution of sire scores for the top matches
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
left_join(ped_top_rec, by=c("id" = "progeny.tag"))
View(sire_scores_top)
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
filter(!is.na(male.parent.accession)) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
left_join(ped_top_rec, by=c("id" = "progeny.tag"))
length(ped_top_rec$male.parent.accession)
nrow(ped_top_rec$male.parent.accession)
nrow(ped_top_rec)
nrow(ped_top_rec %>% filter(!is.na(male.parent.accession)))
# look at distribution of sire scores for the top matches
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
left_join(ped_top_rec, by=c("id" = "progeny.tag")) %>%
filter(!is.na(male.parent.accession))
nrow(sire_scores_top)
nrow(ped_top_rec[!is.na(male.parent.accession),])
head(ped_top_rec)
ped_top_rec <- ped_top %>%
mutate(progeny.name = sub(".*[...]", "", V1)) %>%
mutate(inf.male.name = sub(".*[...]", "", V2)) %>%
left_join(pedigree, by="progeny.name") %>%
rename(progeny.tag = V1)
tail(ped_top_rec)
ped_top_rec <- ped_top %>%
mutate(progeny.name = sub(".*[...]", "", V1)) %>%
mutate(inf.male.name = sub(".*[...]", "", V2)) %>%
left_join(pedigree, by="progeny.name") %>%
filter(type == "biparental") %>%
rename(progeny.tag = V1)
head(ped_top_rec)
tail(ped_top_rec)
nrow(ped_top_rec)
# look at distribution of sire scores for the top matches
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
left_join(ped_top_rec, by=c("id" = "progeny.tag"))
correct_top_matches <- sire_scores_top %>%
filter(!is.na(male.parent.accession)) %>% #filters for biparental crosses only
filter(inf.male.name == male.parent.accession) %>% #filters for AlphaAssign / pedigree matches
filter(estSire < 50000) #also must pass a threshold
nrow(correct_top_matches)
ped_top <- read.table("Maternal_given_run/AlphaAssignResultsGivenMaternal.pedigree.top")
ped_top_rec <- ped_top %>%
mutate(progeny.name = sub(".*[...]", "", V1)) %>%
mutate(inf.male.name = sub(".*[...]", "", V2)) %>%
left_join(pedigree, by="progeny.name") %>%
#filter(type == "biparental") %>%
rename(progeny.tag = V1)
male_top_match <- ped_top_rec %>%
filter(!is.na(male.parent.accession)) %>%
filter(inf.male.name == male.parent.accession)
#nrow(male_top_match) = 134
#wow, 134 correct matches. The default AlphaAssign threshold must have been very strict.
# look at distribution of sire scores for the top matches
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
left_join(ped_top_rec, by=c("id" = "progeny.tag"))
#(this includes open-pollinated crosses unless you filter it out)
#subset for male parents that match between pedigree and alphaassign
correct_top_matches <- sire_scores_top %>%
filter(!is.na(male.parent.accession)) %>% #filters for biparental crosses only
filter(inf.male.name == male.parent.accession) %>% #filters for AlphaAssign / pedigree matches
filter(estSire < 50000) #also must pass a threshold
#nrow(correct_top_matches) = 146
#Compare score distribution for correct matches vs all sire scores
#hist(correct_top_matches$estSire)
#hist(sire_scores$estSire)
#the correct matches distribution seems to pretty well match the lower peak in all of the scores
ped_top <- read.table("Maternal_given_run/AlphaAssignResultsGivenMaternal.pedigree.top")
ped_top_rec <- ped_top %>%
mutate(progeny.name = gsub(".*[...]", "", V1)) %>%
mutate(inf.male.name = gsub(".*[...]", "", V2)) %>%
left_join(pedigree, by="progeny.name") %>%
#filter(type == "biparental") %>%
rename(progeny.tag = V1)
head(ped_top_rec)
nrow(ped_top_rec)
male_top_match <- ped_top_rec %>%
filter(!is.na(male.parent.accession)) %>%
filter(inf.male.name == male.parent.accession)
nrow(male_top_match)
tail(male_top_match)
head(male_top_match)
View(male_top_match)
head(male_top_match)
head(sire_scores)
head(male_top_match)
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
right_join(male_top_match, by=list("id" = "progeny.tag", "candidate" = "V2"))
# look at distribution of sire scores for the top matches
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
right_join(male_top_match, by=c("id" = "progeny.tag", "candidate" = "V2"))
head(sire_scores_top)
tail(sire_scores_top)
nrow(sire_scores_top)
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
right_join(male_top_match, by=c("id" = "progeny.tag", "candidate" = "V2")) %>%
filter(estSire < 50000) #also filter to pass a score threshold
nrow(sire_scores_top)
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
right_join(male_top_match, by=c("id" = "progeny.tag", "candidate" = "V2"))
hist(sire_scores_top$estSire)
nrow(sire_scores_top)
View(sire_scores_top)
sire_scores <- read.table("Maternal_given_run/AlphaAssignResultsGivenMaternal.sires", header=T)
nrow(sire_scores)
nrow(sire_scores)
nrow(sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1))
nrow(sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
filter(chosen == 1))
nrow(sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) )
head(sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
mutate(top.male.name = gsub(".*[...]", "", candidate)) )
head(male_top_match)
sire_scores_top <- sire_scores %>%
dplyr::select(id, candidate, score, chosen, estSire) %>%
#mutate(top.male.name = gsub(".*[...]", "", candidate)) %>%
right_join(male_top_match, by=c("id" = "progeny.tag", "candidate" = "V2")) %>%
filter(estSire < 50000)
nrow(sire_scores_top)
hist(sire_scores_top$estSire)
hist(sire_scores$estSire)
seg_totest <- unique(male_top_match$progeny.name)
seg_totest
length(seg_totest)
nrow(sire_scores_top)
seg_totest <- unique(sire_scores_top$progeny.name)
length(seg_totest)
#read in KASP marker genotypes
geno.sum <- readRDS("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Genotype_data/SNgenotypes_geno.sum.RDS")
kasps_ped <- geno.sum %>% mutate(progeny.name =
gsub("_.*", "", geno.sum$SubjectID)) %>%
right_join(sire_scores_top, by="progeny.name")
nrow(kasps_ped)
parentlist <- unique(c(pedigree$female.parent.accession, pedigree$male.parent.accession))
parent.genos = geno.sum[geno.sum$accession %in% parentlist,]
i <- 2
hetparents = parent.genos[parent.genos[,i] == 1, 'accession']
hetparents
head(parent.genos)
parentlist
head(geno.sum$accession)
head(geno.sum)
head()
head(geno.sum %>% mutate(progeny.name =
gsub("_.*", "", geno.sum$SubjectID)))
tail(geno.sum %>% mutate(progeny.name =
gsub("_.*", "", geno.sum$SubjectID)))
tail(sire_scores_top$progeny.name)
class(sire_scores_top$progeny.name)
tail(geno.sum %>% mutate(progeny.name =
gsub("_.*", "", geno.sum$SubjectID)))
nrow(geno.sum %>% mutate(progeny.name =
gsub("_.*", "", geno.sum$SubjectID)) %>%
right_join(sire_scores_top, by="progeny.name"))
kasps_ped <- geno.sum %>% mutate(progeny.name =
gsub("_.*", "", geno.sum$SubjectID)) %>%
right_join(sire_scores_top, by="progeny.name")
nrow(kasps_ped)
head(kasps_ped)
parentlist
class(parentlist)
class(geno.sum$accession)
class(geno.sum$progeny.name)
head(kasps_ped)
#read in KASP marker genotypes
geno.sum <- readRDS("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Genotype_data/SNgenotypes_geno.sum.RDS") %>%
mutate(progeny.name = gsub("_.*", "", geno.sum$SubjectID))
# merge with pedigree validation results
kasps_ped <- geno.sum %>%
right_join(sire_scores_top, by="progeny.name")
nrow(kasps_ped)
parentlist <- unique(c(pedigree$female.parent.accession, pedigree$male.parent.accession))
parent.genos = geno.sum[geno.sum$progeny.name %in% parentlist,]
nrow(parent.genos)
i <- 2
segprogeny = kasps_ped[kasps_ped$female.parent.accession %in% hetparents
& kasps_ped$male.parent.accession %in% hetparents,]
nrow(seg_progeny)
nrow(segprogeny)
hetparents
parent.genos
head(parent.genos)
hetparents = parent.genos[parent.genos[,i] == 1, 'progeny.name']
hetparents
segprogeny = kasps_ped[kasps_ped$female.parent.accession %in% hetparents
& kasps_ped$male.parent.accession %in% hetparents,]
segprogeny
nrow(segprogeny)
for(i in 2:11){
print(i)
#list parents that are hets at kasp i
hetparents = parent.genos[parent.genos[,i] == 1, 'progeny.name']
#select progeny for which both parents are het at kasp i
segprogeny = kasps_ped[kasps_ped$female.parent.accession %in% hetparents
& kasps_ped$male.parent.accession %in% hetparents,]
N = nrow(segprogeny)
print(N)
}
chitest = chisq.test(table(segprogeny[,i]), p=c(0.25,0.5,0.25))
chitest
#Test segregation ratios for each marker
for(i in 2:11){
print(i)
#list parents that are hets at kasp i
hetparents = parent.genos[parent.genos[,i] == 1, 'progeny.name']
#select progeny for which both parents are het at kasp i
segprogeny = kasps_ped[kasps_ped$female.parent.accession %in% hetparents
& kasps_ped$male.parent.accession %in% hetparents,]
N = nrow(segprogeny)
#print(N)
#look at ratios
#print(table(segprogeny[,i+1])/sum(table(segprogeny[,i+1])))
#chi-square test:
chitest = chisq.test(table(segprogeny[,i]), p=c(0.25,0.5,0.25))
print(chitest$p.value)
}
#look at ratios
print(table(segprogeny[,i+1])/sum(table(segprogeny[,i+1])))
table(segprogeny[,i+1])
table(segprogeny[,2])
table(segprogeny[,3])
table(segprogeny[,i])/sum(table(segprogeny[,i])
)
#Test segregation ratios for each marker
for(i in 2:11){
print(i)
#list parents that are hets at kasp i
hetparents = parent.genos[parent.genos[,i] == 1, 'progeny.name']
#select progeny for which both parents are het at kasp i
segprogeny = kasps_ped[kasps_ped$female.parent.accession %in% hetparents
& kasps_ped$male.parent.accession %in% hetparents,]
N = nrow(segprogeny)
#print(N)
#look at ratios
#print(table(segprogeny[,i])/sum(table(segprogeny[,i])))
#chi-square test:
chitest = chisq.test(table(segprogeny[,i]), p=c(0.25,0.5,0.25))
print(chitest$p.value)
#make and save histograms:
#png(filename=paste0("../Segregation/genofrequencies_kasp",i-1,".png"),
#     width=3.5, height=4, res=300, units="in")
#
barplot(table(as.factor(segprogeny[,i]))/sum(table(as.factor(segprogeny[,i]))),
main = paste0("kasp #",i-1,"; n=",N,"; p=", signif(chitest$p.value, digits=3)),
xlab= "", #glaziovii allele dosage
col=c("#E8E8E8","#EDAB2F","#437CD1"),
ylim=c(0,0.5))
#axis(2,at=seq(0,0.5,0.25))
#title(sub= paste0("p=", signif(chitest$p.value, digits=3)))
#dev.off()
}
parentlist %in% ped_inferred$V1
parentlist %in% ped_inferred$V2
head(ped_inferred_rec)
parentlist %in% ped_inferred_rec$progeny.name
sum(parentlist %in% ped_inferred_rec$progeny.name)
length(parentlist)
library(genomicMateSelectR)
install.packages("remotes")
remotes::install_github("wolfemd/genomicMateSelectR")
knitr::opts_chunk$set(echo = TRUE)
DosageMatrix <- readRDS("~/Desktop/Research/Glaziovii_introgression/Ubiaja_Trials_2020/DosageMatrix_RefPanelAndGSprogeny_ReadyForGP_73019.rds")
DosageMatrix[1:5,1:5]
list_so_far <- read.csv("~/Downloads/HighTC_accessions_for_DArTSeq - Sheet1.csv")
length(list_so_far$accession_name)
length(unique(list_so_far$accession_name))
?duplicated()
duplicated(list_so_far)
list_so_far[duplicated(list_so_far$accession_name),]
duplicates <- list_so_far[duplicated(list_so_far$accession_name), "accession_name"]
list_so_far %>% filter(accession_name %in% duplicates)
list_so_far %>% filter(accession_name == "IITA-TMS-IBA210222")
duplicates
list_so_far[duplicated(list_so_far$accession_name), ]
Gabylist <- read.csv("~/Downloads/Gaby's_list.xlsx - Samples prepared for DARTseq.csv)
""
)
Gabylist <- read.csv("~/Downloads/Gaby's_list.xlsx - Samples prepared for DARTseq.csv")
Gabylist <- read.csv("~/Downloads/Gaby's_list.xlsx - Samples prepared for DARTseq.csv")
head(Gabylist)
Gabylist$Accessions !%in% list_so_far$accession_name
Gabylist$Accessions %in% list_so_far$accession_name
Gabylist[Gabylist$Accessions %in% list_so_far$accession_name == F,]
list_so_far$accession_name[list_so_far$accession_name %in% Gabylist$Accessions]
list_so_far[list_so_far$accession_name %in% Gabylist$Accessions,]
list_so_far[list_so_far$accession_name %in% Gabylist$Accessions == F,]
list_so_far[list_so_far$accession_name %in% Gabylist$Accessions == F,]
nrow(list_so_far[list_so_far$accession_name %in% Gabylist$Accessions == F,])
nrow(Gabylist)
nrow(list_so_far)
list_so_far[list_so_far$accession_name %in% Gabylist$Accessions == F,]
