scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank())
print(heatmap)
}
make.heatmap.facet(trait="stem_diam", "white", "dark blue",
title="stem diameter in mm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap= ggplot(data=tograph, aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
print(heatmap)
}
make.heatmap.facet(trait="stem_diam", "white", "dark blue",
title="stem diameter in mm")
library(ggpubr)
head(tograph)
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data=tograph %>% filter(megablock == 1),
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
heatmap2= ggplot(data=tograph %>% filter(megablock == 2),
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
print(heatmap)
}
make.heatmap.facet(trait="stem_diam", "white", "dark blue",
title="stem diameter in mm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= (tograph %>% filter(megablock == 1)),
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
heatmap2= ggplot(data= (tograph %>% filter(megablock == 2)),
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
print(heatmap)
}
make.heatmap.facet(trait="stem_diam", "white", "dark blue",
title="stem diameter in mm")
tograph.m1 = master[master$row>0 & !is.na(master$block),] %>% filter(megablock == 1)
tograph.m2 = master[master$row>0 & !is.na(master$block),] %>% filter(megablock == 2)
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
heatmap2= ggplot(data= tograph.m2,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
print(heatmap)
}
make.heatmap.facet(trait="stem_diam", "white", "dark blue",
title="stem diameter in mm")
ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
heatmap2= ggplot(data= tograph.m2,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
print(allblocks)
}
make.heatmap.facet(trait="stem_diam", "white", "dark blue",
title="stem diameter in mm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
# heatmap2= ggplot(data= tograph.m2,
#                  aes_string("row", "plant_pos_scaled",
#                   fill= trait, height=7, width=1)) +
#   geom_tile() +
#   scale_fill_gradient(low=col1, high=col2, na.value = "white") +
#   ggtitle(title) +
#   theme(axis.text.y=element_blank(),
#         axis.line.y = element_blank(),
#         axis.title.y = element_blank(),
#         axis.ticks.y = element_blank()) +
#   facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
#   theme(strip.background = element_blank(), strip.text = element_blank())
#
# allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
#
# print(allblocks)
print(heatmap1)
}
make.heatmap.facet(trait="stem_diam", "white", "dark blue",
title="stem diameter in mm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
#facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
#theme(strip.background = element_blank(), strip.text = element_blank())
# heatmap2= ggplot(data= tograph.m2,
#                  aes_string("row", "plant_pos_scaled",
#                   fill= trait, height=7, width=1)) +
#   geom_tile() +
#   scale_fill_gradient(low=col1, high=col2, na.value = "white") +
#   ggtitle(title) +
#   theme(axis.text.y=element_blank(),
#         axis.line.y = element_blank(),
#         axis.title.y = element_blank(),
#         axis.ticks.y = element_blank()) +
#   facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
#   theme(strip.background = element_blank(), strip.text = element_blank())
#
# allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
#
# print(allblocks)
print(heatmap1)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank())
#facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
#theme(strip.background = element_blank(), strip.text = element_blank())
# heatmap2= ggplot(data= tograph.m2,
#                  aes_string("row", "plant_pos_scaled",
#                   fill= trait, height=7, width=1)) +
#   geom_tile() +
#   scale_fill_gradient(low=col1, high=col2, na.value = "white") +
#   ggtitle(title) +
#   theme(axis.text.y=element_blank(),
#         axis.line.y = element_blank(),
#         axis.title.y = element_blank(),
#         axis.ticks.y = element_blank()) +
#   facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
#   theme(strip.background = element_blank(), strip.text = element_blank())
#
# allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
#
# print(allblocks)
print(heatmap1)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= plant_height, height=7, width=1))
head(to.graphm1)
head(tograph.m1)
tograph.m1 = master[master$row>0 & !is.na(master$block),] %>% filter(megablock == 1)
head(tograph.m1)
head(master)
tograph.m1 = master[master$row>0 & !is.na(master$block),] %>% filter(megablock == "1")
head(tograph.m1)
tograph.m1 = master[master$row>0 & !is.na(master$block) & master$megablock == 1,]
tograph.m2 = master[master$row>0 & !is.na(master$block)& master$megablock == 2,]
head(tograph.m1)
head(master)
head(master[master$megablock == 1,])
head(master[master$megablock == "1",])
head(master[megablock == "1",])
master$megablock[master$megablock == 1]
head(master$megablock)
head(master)
master$megablock = NA
master$megablock[master$block == 1 | master$block == 2 | master$block == 3  | master$block == 4] <- 1
master$megablock[master$block == 5 | master$block == 6] <- 2
#make unique name for block/row combination
master$block.row = paste(master$block, master$row, sep=".")
head(master)
tograph.m1 = master[master$row>0 & !is.na(master$block) & master$megablock == 1,]
tograph.m2 = master[master$row>0 & !is.na(master$block) & master$megablock == 2,]
head(tograph.m1)
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
heatmap2= ggplot(data= tograph.m2,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v",
levels=c(4,3,2,1), as.table=FALSE)) +
theme(strip.background = element_blank(), strip.text = element_blank())
heatmap2= ggplot(data= tograph.m2,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v",
levels=c(4,3,2,1), as.table=FALSE) +
theme(strip.background = element_blank(), strip.text = element_blank())
heatmap2= ggplot(data= tograph.m2,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
master$block = as.factor(block)
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph.m1,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v",
levels=c(4,3,2,1), as.table=FALSE) +
theme(strip.background = element_blank(), strip.text = element_blank())
heatmap2= ggplot(data= tograph.m2,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v")+
theme(strip.background = element_blank(), strip.text = element_blank())
allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
tograph = master[master$row>0 & !is.na(master$block),]
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v") +
theme(strip.background = element_blank(), strip.text = element_blank())
print(heatmap1)
#allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
#print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v", as.table=FALSE) +
theme(strip.background = element_blank(), strip.text = element_blank())
print(heatmap1)
#allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
#print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v", as.table=TRUE) +
theme(strip.background = element_blank(), strip.text = element_blank())
print(heatmap1)
#allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
#print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v", as.table=FALSE) +
theme(strip.background = element_blank(), strip.text = element_blank())
print(heatmap1)
#allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
#print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
make.heatmap.facet = function(trait, col1, col2, title){
heatmap1= ggplot(data= tograph,
aes_string("row", "plant_pos_scaled",
fill= trait, height=7, width=1)) +
geom_tile() +
scale_fill_gradient(low=col1, high=col2, na.value = "white") +
ggtitle(title) +
theme(axis.text.y=element_blank(),
axis.line.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()) +
facet_wrap(~block, ncol = 2, nrow = 4, dir="v") +
theme(strip.background = element_blank(), strip.text = element_blank())
print(heatmap1)
#allblocks = ggarrange(heatmap2,heatmap1, ncol = 2)
#print(allblocks)
}
make.heatmap.facet(trait="plant_height", "white", "dark green",
title="plant height in cm")
