odds_function(0.75)
odds_function(0.72)
odds_function(0.71)
odds_function(0.721)
odds_function(0.723)
odds_function(0.719)
odds_function(0.715)
odds_function(0.714)
odds_function(0.7151)
odds_function(0.7149)
odds_function(0.7148)
odds_function(0.71485)
odds_function(0.71483)
odds_function(0.71481)
odds_function(0.714815)
odds_function(0.714814)
odds_function(0.7148139)
logodds5
logodd6 <- -0.37469+0.56788+-0.69450+-0.43581
odds6 <- exp(logodd6)
odds6
odds_function(0.2)
odds_function(0.3)
odds_function(0.25)
odds_function(0.26)
odds_function(0.27)
odds_function(0.29)
odds_function(0.28)
odds_function(0.285)
odds_function(0.283)
odds_function(0.282)
odds_function(0.281)
odds_function(0.2816)
odds_function(0.2815)
odds_function(0.2814)
odds_function(0.28148)
0.28148*27
oldcount = -0.37469 + -0.67513
yngintl <- -0.37469+0.56788 +0.15155 + 0.57414
exp(yngintl) / (1 + exp(yngintl))
-0.37469+0.56788
library(knitr)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=FALSE, echo = TRUE)
library(ggplot2)
library(MASS)
xa <- c(runif(275,min=0,max=50), runif(45,50,100))
y <- round(xa/100)
xa <- c(rep(-1,1640),rep(0,0),rep(1,8),
rep(-1,1640),rep(0,0),rep(1,1))
y <- c(rep(0,1648), rep(1,1641))
test_data <- data.frame("pheno" = y, "Xa" = xa)
ggplot(test_data,aes(Xa,pheno))+geom_jitter(width=0.1,height=0.1)+geom_smooth(method=lm)
linearModel <- lm(pheno ~ Xa, data=test_data)
cat("The PVal is", summary(linearModel)$coefficients[2,4]," for linear regression \n")
logisticModel <- glm(pheno ~ Xa, data=test_data, family="binomial")
cat("The PVal is", summary(logisticModel)$coefficients[2,4]," for logistic regression")
x <- seq(-1,1,by = 0.1)
y_linear <- x * 4
y_logistic <- 1 / ( 1 + exp(-y_linear))
par(mfrow = c(1,2))
plot(x, y_linear, main = "Linear function", type = "l")
abline(h = 0, col = "red", lty = 2)
abline(h = 1, col = "red", lty = 2)
plot(x,y_logistic, main = "logistic regression curve", type ="l", ylim = c(-0.5,1.5))
abline(h = 0, col = "red", lty = 2)
abline(h = 1, col = "red", lty = 2)
knitr::include_graphics("newtons-method.png")
zero_func <- function(x) {
exp(2 * x) - x - 6
}
x_val <- seq(-5, 5, length.out = 100)
y_val <- zero_func(x_val)
ggplot(data.frame(x_val, y_val), aes(x_val, y_val)) + geom_point() +
xlim(-5,5) + ylim(-6,5) +
geom_hline(yintercept = 0) + geom_vline(xintercept = 0)
zero_func_deriv <- function(x) {
2*exp(2 * x) - 1
}
zero_func_deriv <- function(x) {
2*exp(2 * x) - 1
}
threshold <- 0.001
current_val <- 0.8
diff <- NA
for(iter in 1:100){
cat("This is iteration:", iter, "\n")
cat("The current difference is:", diff, "\n\n")
next_val <- current_val - (zero_func(current_val)/zero_func_deriv(current_val))
diff <- abs(next_val - current_val)
if(diff < threshold){
break
} else {
current_val <- next_val
}
}
cat("The zero value is:", current_val)
uniroot(zero_func, c(0.5,2))$root
gamma_inv_calc <- function(X_mx, beta_t){
K <- X_mx %*% beta_t
gamma_inv <- exp(K)/(1+exp(K))
return(gamma_inv)
}
W_calc <- function(gamma_inv){
W <- diag(as.vector(gamma_inv * (1- gamma_inv)))
return(W)
}
beta_update <- function(X_mx, W, Y, gamma_inv, beta){
beta_up <- beta + ginv(t(X_mx)%*%W%*%X_mx)%*%t(X_mx)%*%(Y-gamma_inv)
return(beta_up)
}
dev_calc <- function(Y, gamma_inv){
deviance <- 2*(sum(Y[Y==1]*log(Y[Y==1]/gamma_inv[Y==1])) +
sum((1-Y[Y==0])*log((1-Y[Y==0])/(1-gamma_inv[Y==0]))))
return(deviance)
}
loglik_calc <- function(Y, gamma_inv){
loglik <- sum(Y*log(gamma_inv)+(1-Y)*log(1-gamma_inv))
return(loglik)
}
Y <- read.table("phenotypes-logistic.tsv", header = T,stringsAsFactors = F)
Y <- read.table("./phenotypes-logistic.tsv", header = T,stringsAsFactors = F)
getwd()
Y <- read.table("phenotypes-logistic.tsv", header = T, stringsAsFactors = F)
geno <- read.table("genotypes-logistic.tsv", header = T)
hist(Y[,1])
Y <- as.matrix(Y)
colnames(Y) <- NULL
Y[Y[,1] < 0.5, 1] <- 0
Y[Y[,1] > 0.5, 1] <- 1
xa_matrix <- as.matrix(geno)
xd_matrix <- 1 - 2*abs(xa_matrix)
X_mx <- cbind(1, xa_matrix[,1], xd_matrix[,1])
h1_List <- logistic.IRLS(Y=Y, X_mx=X_mx)
?logistic.IRLS
??logistic.IRLS
## Note that I changed the inputs of the function from last lab. We now have X_mx as an input rather than each Xa and Xd matrix
logistic.IRLS<- function(X_mx,Y =Y, beta.initial.vec = c(0,0,0),
d.stop.th = 1e-6, it.max = 100) {
#check this matrix:
#initialize the beta parameter vector at t=0
beta_t <- beta.initial.vec
# initialize deviance at d[t]
dt <- 0
#initialize gamma
# K is the part which goes into the exponent
gamma_inv <- gamma_inv_calc(X_mx, beta_t)
for(i in 1:it.max) {
dpt1 <- dt #store previous deviance
# create empty matrix W
W <- W_calc(gamma_inv)
beta_t <- beta_update(X_mx, W, Y, gamma_inv, beta_t)
#update gamma since it's a function of beta
gamma_inv <- gamma_inv_calc(X_mx, beta_t)
#calculate new deviance
dt <- dev_calc(Y, gamma_inv)
absD <- abs(dt - dpt1)
if(absD < d.stop.th) {
#cat("Convergence at iteration:", i, "at threshold:", d.stop.th, "\n")
logl <- loglik_calc(Y, gamma_inv)
return(list(beta_t,logl))
}
}
#cat("Convergence not reached after iteration:", i, "at threshold:", d.stop.th, "\n")
return(list(beta_t= c(NA,NA,NA),logl=NA))
}
Y <- as.matrix(Y)
colnames(Y) <- NULL
Y[Y[,1] < 0.5, 1] <- 0
Y[Y[,1] > 0.5, 1] <- 1
xa_matrix <- as.matrix(geno)
xd_matrix <- 1 - 2*abs(xa_matrix)
X_mx <- cbind(1, xa_matrix[,1], xd_matrix[,1])
h1_List <- logistic.IRLS(Y=Y, X_mx=X_mx)
cat("The betas are ",h1_List[[1]], "and the log likelihood is ", h1_List[[2]])
X_mx <- cbind(1, rep(0,nrow(Y)), rep(0,nrow(Y)))
h0_List <- logistic.IRLS(Y=Y, X_mx=X_mx)
LRT<-2*h1_List[[2]]-2*h0_List[[2]] #likelihood ratio test statistic
pval <- pchisq(LRT, 2, lower.tail = F)
cat("The pval is", pval)
logistic.IRLS.pval <- function( Xa, Xd,Y, beta.initial.vec = c(0,0,0),
d.stop.th = 1e-6, it.max = 100) {
#Initialize
beta_t <- beta.initial.vec
dt <- 0
X_mx <- cbind(rep(1,nrow(Y)), Xa, Xd)
gamma_inv <- gamma_inv_calc(X_mx, beta_t)
h1 <- logistic.IRLS( X_mx, Y=Y, beta.initial.vec = c(0,0,0),
d.stop.th = 1e-6, it.max = 100)
X_mx <- cbind(rep(1,nrow(Y)), rep(0,nrow(Y)),rep(0,nrow(Y)))
gamma_inv <- gamma_inv_calc(X_mx, beta_t)
h0 <- logistic.IRLS( X_mx, Y=Y, beta_t, d.stop.th = 1e-6, it.max = 100)
LRT <- 2*h1[[2]]-2*h0[[2]] #likelihood ratio test statistic
pval <- pchisq(LRT, 2, lower.tail = F)
return(pval)
}
recurse_fibonacci <- function(n) {
if(n == 0) {
return(n)
} else if (n==1) {
return(1)
} else {
return(recurse_fibonacci(n-1) + recurse_fibonacci(n-2))
}
}
recurse_fibonacci(4)
#0 + 1 + 1 + 2 + 3 + 5 + 8 + ...
recurse_fibonacci <- function(n) {
if(n == 0) {
return(n)
} else if (n==1) {
return(1)
} else {
return(recurse_fibonacci(n-1) + recurse_fibonacci(n-2))
}
}
recurse_fibonacci(4)
#0 + 1 + 1 + 2 + 3 + 5 + 8 + ...
logistic.IRLS.recursive <- function(Y, X_mx, beta_t, dpt1, gamma_inv,
iter, d.stop.th = 1e-6, it.max = 100){
# create empty matrix W
W <- W_calc(gamma_inv)
beta_t <- beta_update(X_mx, W, Y, gamma_inv, beta_t)
#update gamma since it's a function of beta
gamma_inv <- gamma_inv_calc(X_mx, beta_t)
#calculate new deviance
dt <- dev_calc(Y, gamma_inv)
absD <- abs(dt - dpt1)
if(absD < d.stop.th | iter > it.max) {
#cat("Convergence at iteration:", i, "at threshold:", d.stop.th, "\n")
logl <- loglik_calc(Y, gamma_inv)
return(list(beta_t,logl))
}	else {
return(logistic.IRLS.recursive(Y, X_mx, beta_t, dt, gamma_inv, iter+1,
d.stop.th = 1e-6, it.max = 100))
}
}
?odds_function
odds_function(5.3)
exp(5.3)
oi<-exp(5.3)
oi/(1+oi)
odds_function(oi)
probability_from_logodds <- function(logoi) {oi <- exp(logoi)
pi <- oi/(1+oi)
return(pi)}
malem <- 3,486
malem <- 3486
femalem <- 3,679
femalem <- 3679
totalm = malem+femalem
malem/totalm
femalem/totalm
0.487+0.514
0.5135 + 0.4865
-0.37469 + 0.56788
-0.37469 + 0.15155
exp(-0.37469 + 0.15155 )
exp(-0.37469 + 0.56788 + 0.15155 + 0.57414)
odds <- exp(-0.37469 + 0.56788 + 0.15155 + 0.57414)
odds/(1+odds)
odds/(1-odds)
library(tidyverse, stringr)
setwd("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/")
### Seren's attempt to replicate Ariel's chi-squared results.
# The findings are similar but not the same because the way we calculate the total number of meioses is different
# diffmeiocount: This method counts only the number of meioses present in the CO dataset for the introgressed chromosome
# that way, if there is no crossover observed for a certain chromosome within a certain meioses, it is not counted against the total
# because we assume there was at least one crossover per chromosome per meiosis even if we couldn't detect it
#this is manuscript version 2b.
dosage <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/meanDoseGlaz_250Kwindows_AllPops_31519.rds")    # dosage for M. Glaz. allele
#dosagecopy <- dosage
#parents <- readRDS("parents.rds")            # list of parents that I asked Marnin to look up (n=197)
key <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/parents_gbsID_50219.rds")    # list of parents that I asked Marnin to look up (n=196) plus their associated GBS ID
crossovers1.list <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/maxna/all_chroms/chr001_maxna0.30_t0.5_informative.rds")
crossovers1 <- as.data.frame(unlist(crossovers1.list))
crossovers4.list <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/maxna/all_chroms/chr004_maxna0.30_t0.5_informative.rds")
crossovers4 <- as.data.frame(unlist(crossovers4.list))
# aggregate all of the meioses and crossovers genome-wide
meioses.gw.faircount = c()
#COs.gw.faircount = data.frame()
filepath = "maxna/all_chroms/"
for(chrom in 1:18){
chrompad <- str_pad(chrom, 3, "left", 0)
meios_thischrom <- readRDS(paste(filepath,"chr", chrompad, "_maxna0.30_t0.5_informative.rds", sep=""))
#COs_thischrom = unlist(meios_thischrom)
meioses.gw.faircount = c(meioses.gw.faircount, names(meios_thischrom))
#COs.genome.wide = rbind(COs.genome.wide, as.data.frame(COs_thischrom))
}
head(meioses.gw.faircount)
tail(meioses.gw.faircount)
?str_extract
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount.parents, '[^\\.]')
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '[^\\.]')
head(meioses.gw.faircount.parents)
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '[^\\.]+')
meioses.gw.faircount.parents
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '[\\.]*')
head(meioses.gw.faircount.parents)
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '\\.*')
head(meioses.gw.faircount.parents)
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '.*\\.')
head(meioses.gw.faircount.parents)
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '\\.*')
head(meioses.gw.faircount.parents)
head(meioses.gw.faircount)
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '\\.*.')
head(meioses.gw.faircount)
head(meioses.gw.faircount.parents)
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '\\.^')
head(meioses.gw.faircount.parents)
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '\\.(.*)')
head(meioses.gw.faircount.parents)
head(meioses.gw.faircount)
chrom=1
chrompad <- str_pad(chrom, 3, "left", 0)
filepath = "maxna/all_chroms/"
setwd("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/")
meios_thischrom <- readRDS(paste(filepath,"chr", chrompad, "_maxna0.30_t0.5_informative.rds", sep=""))
head(names(meios_thischrom))
tail(names(meios_thischrom))
tail(names(meios_thischrom), n=100)
tail(names(meios_thischrom), n=400)
head(names(meios_thischrom), n=400)
library(tidyverse, stringr)
setwd("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/")
### Seren's attempt to replicate Ariel's chi-squared results.
# The findings are similar but not the same because the way we calculate the total number of meioses is different
# diffmeiocount: This method counts only the number of meioses present in the CO dataset for the introgressed chromosome
# that way, if there is no crossover observed for a certain chromosome within a certain meioses, it is not counted against the total
# because we assume there was at least one crossover per chromosome per meiosis even if we couldn't detect it
#this is manuscript version 2b.
dosage <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/meanDoseGlaz_250Kwindows_AllPops_31519.rds")    # dosage for M. Glaz. allele
#dosagecopy <- dosage
#parents <- readRDS("parents.rds")            # list of parents that I asked Marnin to look up (n=197)
key <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/parents_gbsID_50219.rds")    # list of parents that I asked Marnin to look up (n=196) plus their associated GBS ID
crossovers1.list <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/maxna/all_chroms/chr001_maxna0.30_t0.5_informative.rds")
crossovers1 <- as.data.frame(unlist(crossovers1.list))
crossovers4.list <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/maxna/all_chroms/chr004_maxna0.30_t0.5_informative.rds")
crossovers4 <- as.data.frame(unlist(crossovers4.list))
# aggregate all of the meioses and crossovers genome-wide
meioses.gw.faircount = c()
#COs.gw.faircount = data.frame()
filepath = "maxna/all_chroms/"
for(chrom in 1:18){
chrompad <- str_pad(chrom, 3, "left", 0)
meios_thischrom <- readRDS(paste(filepath,"chr", chrompad, "_maxna0.30_t0.5_informative.rds", sep=""))
#COs_thischrom = unlist(meios_thischrom)
meioses.gw.faircount = c(meioses.gw.faircount, names(meios_thischrom))
#COs.genome.wide = rbind(COs.genome.wide, as.data.frame(COs_thischrom))
}
meioses.gw.faircount.parents <- str_extract(meioses.gw.faircount, '\\.(.*)') #extract the parents of the informative meiosis
COcountsum = matrix(nrow=3,ncol=4,
dimnames=list(c("dose0","dose1","dose2"),
c("chr1_inside","chr1_outside","chr4_inside","chr4_outside")))
for(chr in c(1,4)){
chrom <- chr
chrompad <- str_pad(chr, 3, "left", 0)
target <- grep(paste("^", chrom, "$", sep=""), dosage$Chr)
subset <- do.call(rbind, dosage$doseGlazInWindows[target])
subset <- subset[subset$IID %in% key$FullSampleName, ]         # only include individuals of interest (i.e. those listed in key)
if(chrom == 1){ subset <- subset[subset$Start >= 25000000,] }
if(chrom == 4){ subset <- subset[(subset$Start >= 5000000 | subset$Start == 5000000) & (subset$Stop < 25000000 | subset$Stop == 25000000),] }
probands <- unique(subset$IID)
#proband <- probands[1]
meandose <- sapply(probands, function(proband){ mean(subset$meanDoseGlaz[grep(paste("^", proband, "$", sep=""), subset$IID)]) })
# round to either 0, 1, or 2
meandose[meandose > 0 & meandose < 0.5] <- 0
meandose[meandose > 0.5 & meandose < 1.5 | meandose == 0.5 & meandose < 1.5 ] <- 1
meandose[meandose > 1.5 & meandose < 2 | meandose == 1.5 & meandose < 2] <- 2
# rename meandose (currently using the FullSampleName; use germplasmName instead)
newname <- c()
for (i in names(meandose)){
newname <- c(newname, key$germplasmName[grep(paste("^", i, "$", sep=""), key$FullSampleName)])
}
names(meandose) <- newname
meandose = as.data.frame(meandose)
meandose$parent = rownames(meandose)
crossovers = get(paste0("crossovers",chrom))
colnames(crossovers)[1] <- "interval"
crossovers$meiosis <- rownames(crossovers)
crossovers = separate(crossovers, col=meiosis, sep="\\.", into=c("offspring","parent"))
crossovers = separate(crossovers, col=interval, sep="_", into=c("start","stop"))
crossovers$start <- as.numeric(crossovers$start)
crossovers$stop <- as.numeric(crossovers$stop)
#grep method:
if(chrom == 1){ k=0:2 }
if(chrom == 4){ k=0:1 }
for (j in k){ #iterate for each glaziovii status
thisdose.parents <- meandose[meandose$meandose==j,2]
totalgrep <- c() #which COs intervals (from unlisted dataframe) involve parents of a given dose?
countgrep <- c() #which meioses (from original list) involve parents of a given dose? (needed for calculating expected p for chisq)
for(m in 1:length(thisdose.parents)){
totalgrep <- c(totalgrep, grep(thisdose.parents[m], crossovers$parent))
pattern <- paste(".", thisdose.parents[m], sep="")
countgrep <- c(countgrep, grep(pattern, meioses.gw.faircount.parents))
}
COs.thisdose <- crossovers[totalgrep,] #subset for the CO intervals from parents of this dose
assign(paste0("chr",chrompad,"_j",j,"COs"), COs.thisdose) #name that subset to a new variable
#meioses.thisdose <- get(paste0("crossovers",chrom,".list"))[countgrep] #subset for the meioses from parents of this dose
meioses.thisdose <- meioses.gw.faircount[countgrep]
assign(paste0("meio_count_chr",chrom,"_dose",j), meioses.thisdose) #name that subset to a new variable
#write out files to save:
#filepath = "/Users/serenwork/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/"
#saveRDS(COs.thisdose, paste(filepath,"chr", chrompad, "_j", j, "crossovers.rds", sep=""))
#reload in RDS files if necessary:
#chr001_j0COs <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/chr001_j0crossovers.rds")
#chr001_j1COs <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/chr001_j1crossovers.rds")
#chr001_j2COs <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/chr001_j2crossovers.rds")
#chr004_j0COs <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/chr004_j0crossovers.rds")
#chr004_j1COs <- readRDS("~/Desktop/Research/Chan_paper_revisions/Chan_paper_code_data/chr004_j1crossovers.rds")
#COs.thisdose <- get(paste0("chr",chrompad,"_j",j,"COs"))
if(chrom == 1){ #introgression is 25 Mb to the end of the chromosome 1
inside.COs = subset(COs.thisdose, COs.thisdose$stop >= 25000000)
outside.COs = subset(COs.thisdose, COs.thisdose$stop < 25000000)
COcountsum[j+1, 1] = nrow(inside.COs) #count how many COs inside the region of interest
COcountsum[j+1, 2] = nrow(outside.COs)
}
if(chrom == 4){ #introgression is 5 to 25 Mb on chromosome 4
inside.COs = subset(COs.thisdose, COs.thisdose$stop >= 5000000 & COs.thisdose$start <= 25000000)
outside.COs = subset(COs.thisdose, COs.thisdose$stop < 5000000 | COs.thisdose$start > 25000000)
COcountsum[j+1, 3] = nrow(inside.COs)
COcountsum[j+1, 4] = nrow(outside.COs)
}
#print(c("chrom=",chrompad," insideCOcount=",nrow(inside.COs), " outsideCOcount=", nrow(outside.COs)))
}
}
COcountsum
for (chrom in c(1,4)){
#calculate expected proportions for chi.square test:
if(chrom == 1){
totald0 = length(meio_count_chr1_dose0) #Ariel's text: 2645
totald1 = length(meio_count_chr1_dose1) #Ariel's text: 4047
totald2 = length(meio_count_chr1_dose2) #Ariel's text: 439
total.all = sum(totald0 + totald1 + totald2)
p = c((totald0/total.all), (totald1/total.all), (totald2/total.all))
#Arielexpected = p * sum(COcountsum[1,1:2])
#Arielp = table(data$introgression)/sum(table(data$introgression))
}
if(chrom == 4){
totald0 = length(meio_count_chr4_dose0)
totald1 = length(meio_count_chr4_dose1)
total.all = sum(totald0 + totald1)
p = c((totald0/total.all), (totald1/total.all))
}
if(chrom == 1) {test = 1:2}
if(chrom == 4) {test = 3:4}
for(t in test){
Xsq = chisq.test(na.omit(COcountsum[,t]), p = p)
assign(paste0("chrom",chrom,"chisq",t), Xsq) }
}
###Chi-sq results: Chr1 introgression, within the introgressed region
chrom1chisq1$observed
chrom1chisq1$expected
chrom1chisq1$p.value
#percent difference
(chrom1chisq1$observed-chrom1chisq1$expected) / (chrom1chisq1$expected) *100
###Chi-sq results: Chr1 introgression, outside the introgressed region
chrom1chisq2$observed
chrom1chisq2$expected
chrom1chisq2$p.value
#percent difference
(chrom1chisq2$observed-chrom1chisq2$expected) / (chrom1chisq2$expected) *100
###Chi-sq results: Chr4 introgression, within the introgressed region
chrom4chisq3$observed
chrom4chisq3$expected
chrom4chisq3$p.value
#percent difference
(chrom4chisq3$observed-chrom4chisq3$expected) / (chrom4chisq3$expected) *100
###Chi-sq results: Chr4 introgression, outside the introgressed region
chrom4chisq4$observed
chrom4chisq4$expected
chrom4chisq4$p.value
#percent difference
(chrom4chisq4$observed-chrom4chisq4$expected) / (chrom4chisq4$expected) *100
getwd()
setwd("/Users/serenwork/Desktop/Research/Glaziovii_introgression/KASP_design/Verification_05-2021/")
rawdat = read.csv("Genotyping-014.038-01_reclustering.csv")
head(rawdat)
snps = unique(rawdat$SNPID)
length(snps)
head(snps)
?subset()
raw.sub = subset(rawdat, SNPID == snps[1])
head(raw.sub)
```{r}
setwd("/Users/serenwork/Desktop/Research/Glaziovii_introgression/KASP_design/Verification_05-2021/")
rawdat = read.csv("Genotyping-014.038-01_reclustering.csv")
snps = unique(rawdat$SNPID)
```
setwd("/Users/serenwork/Desktop/Research/Glaziovii_introgression/KASP_design/Verification_05-2021/")
rawdat = read.csv("Genotyping-014.038-01_reclustering.csv")
snps = unique(rawdat$SNPID)
raw.sub = subset(rawdat, SNPID == snps[1])
raw.sub
ggplot(data=raw.sub, aes(x=X, y=Y)) +
geom_point()
for(i in 1:length(snps)) {
raw.sub = subset(rawdat, SNPID == snps[i])
ggplot(data=raw.sub, aes(x=X, y=Y)) +
geom_point()
}
for(i in 1:length(snps)) {
raw.sub = subset(rawdat, SNPID == snps[i])
ggplot(data=raw.sub, aes(x=X, y=Y)) +
geom_point()
}
for(i in 1:length(snps)) {
raw.sub = subset(rawdat, SNPID == snps[i])
plot = ggplot(data=raw.sub, aes(x=X, y=Y)) +
geom_point()
print(plot)
}
