Subset dosage matrix for IDMs:
IDM search list
```{r}
#IDMlist <- as.vector(paste0(strictIDMs1$SNP, "_*"))
#IDMcolslist <- grep(paste(IDMlist,collapse="|"), colnames(UBDosMat), value=TRUE)
IDMposlist <- as.vector(strictIDMs1$Pos)
IDMcolslist2 <- grep(paste(IDMposlist,collapse="|"), colnames(UBDosMat), value=TRUE)
UBDosdf <- data.frame(UBDosMat)
UBDosIDMs <- UBDosdf %>% select(any_of(IDMcolslist2))
#save(UBDosIDMs,file="UBDosMat.Rdata")
#shorten name
genos <- UBDosIDMs
```
# Subset IDM list:
```{r}
IDMset <- strictIDMs1
IDMset <- IDMset %>% select(SNP, Pos, GlazAllele, AltAllele)
```
# Generate new columns that contain SNP position, allele, dosage.
```{r}
#UBDosMat
genosmelt <- melt(as.matrix(genos))
genosmeltS <- separate(genosmelt, Var2, into = c("Chr","Pos","Allele"), sep="_", remove = F, convert = TRUE)
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, message=FALSE, warning=FALSE}
library(plyr)
library(stringr)
library(tidyr)
library(dplyr)
library(reshape2)
library(tidyverse)
library(binr)
```
# Objective:
Calculate the *M. glaziovii* allele dosage at each **IDM** in the SNP datasets of clones at IITA Ubiaja in 2020 (list from Prasad) and in the HapMapII long-read WGS clones (list from Cinta). Determine the average glaziovii allele dosage across the introgression region on chromosome 1 to identify which clones are heterozygous or homozygous esculenta/glaziovii. Graph the glaziovii allele dosages in the introgression regions to identify individuals with interesting/unique recombination break points.
# Data:
Ubiaja list of accession names:
```{r}
setwd("~/Desktop/Research/Ubiaja_Trials")
UB.UYT28 <- read.csv("20.GS.C3.UYT.28.UB.csv")
UB.PYT <- read.csv("20.GS.C4.PYT.80.SETA&SETB.CB.UB.csv")
UB.UYT30 <- read.csv("20.GS.C1.C2.C3.UYT.30.UB.csv")
UB.AYT40 <- read.csv("20.GS.C4B.AYT.40.UB.csv")
UB.AYT42 <- read.csv("20.GS.C4B.AYT.42.UB.csv")
UB.all <- rbind.fill(UB.UYT28, UB.PYT, UB.UYT30, UB.AYT40, UB.AYT42)
UBnames <- as.character(unique(UB.all$accession_name))
#write.csv(UBnames,"~/Desktop/Research/Ubiaja_Trials/UBaccessionnames.csv", row.names = FALSE)
```
WGS long-read list of accession names:
```{r, echo=FALSE}
longnames <- read.csv("~/Desktop/Research/long-reads-list.csv")
```
Dosage matrix for IITA clones (genotype data): subset for Chr 1 and for accessions of interest:
matrix is a list of 0, 1, 2 dosages with row names as accessions and column names as SNPs
```{r}
DosageMatrix <- readRDS("~/Desktop/Research/Ubiaja_Trials/DosageMatrix_RefPanelAndGSprogeny_ReadyForGP_73019.rds")
# Subset for Chr 1
#grepl("S1", names(DosageMatrix[1,]) )
#DosMat1 <- DosageMatrix[grep("S1_", names(DosageMatrix[1,])) , ]
#grep("S1_", names(DosageMatrix[1,]))
# first 8307 observations:
DosMat1 <- DosageMatrix[,1:8307]
```
# Make list of names to subset - only needs to be run once
```{r, eval=FALSE}
# Subset for IITA & long-read accessions:
DosMatnames <- gsub(":.*","", rownames(DosMat1)) #remove genotyping code
DosMatnames1 <- gsub("_A.*","", DosMatnames) #remove DNA sample tag after _A
UBnames1 <- gsub("IITA-TMS-","", UBnames) #remove prefix in UBnames IITA samples
trueintsect <- grep(paste(UBnames1,collapse="|"), DosMatnames1, value=TRUE)
#write.csv(trueintsect,"~/Desktop/Research/Ubiaja_Trials/trueintersect.csv", row.names = FALSE)
# A better way to determine matches and mismatches
lengthUB <- length(UBnames1)
matchstore <- NA
mismatch <- NA
for (i in 1:lengthUB) {
maybematch <- grep(UBnames1[i], DosMatnames1)
if(length(maybematch) == 0){mismatch[i] <- UBnames[i]} else {matchstore[i] <- UBnames[i]}
}
UBmatches <- as.vector(na.omit(matchstore))
UBnotfound <- as.vector(na.omit(mismatch))
#write.csv(UBmatches,"~/Desktop/Research/Ubiaja_Trials/UBmatches.csv", row.names = FALSE)
#write.csv(UBnotfound,"~/Desktop/Research/Ubiaja_Trials/UBnotfound.csv", row.names = FALSE)
```
Possible alternative names:
Is TMS15F1041P0003 = "UG14_1041" or "NR110411"?
(this accession is listed on cassavabase as having been genotyped)
```{r}
#clean up for unique values
u_trueintsect <- read.csv("~/Desktop/Research/Ubiaja_Trials/unique_trueintersect.csv", header=FALSE)
u_trueintsect <- as.vector(u_trueintsect$V1)
#Add NASE14 which has long read data
u_trueintsect[89] <- "NASE14"
UBDosMat.names <- grep(paste(u_trueintsect,collapse="|"), rownames(DosMat1), value=TRUE)
UBDosMat <- subset(DosMat1, rownames(DosMat1) %in% UBDosMat.names)
#save(UBDosMat,file="UBDosMat.Rdata")
```
library(plyr)
library(stringr)
library(tidyr)
library(dplyr)
library(reshape2)
library(tidyverse)
library(binr)
setwd("~/Desktop/Research/Ubiaja_Trials")
UB.UYT28 <- read.csv("20.GS.C3.UYT.28.UB.csv")
UB.PYT <- read.csv("20.GS.C4.PYT.80.SETA&SETB.CB.UB.csv")
UB.UYT30 <- read.csv("20.GS.C1.C2.C3.UYT.30.UB.csv")
UB.AYT40 <- read.csv("20.GS.C4B.AYT.40.UB.csv")
UB.AYT42 <- read.csv("20.GS.C4B.AYT.42.UB.csv")
UB.all <- rbind.fill(UB.UYT28, UB.PYT, UB.UYT30, UB.AYT40, UB.AYT42)
UBnames <- as.character(unique(UB.all$accession_name))
#write.csv(UBnames,"~/Desktop/Research/Ubiaja_Trials/UBaccessionnames.csv", row.names = FALSE)
setwd("~/Desktop/Research/Ubiaja_Trials")
UB.UYT28 <- read.csv("20.GS.C3.UYT.28.UB.csv")
UB.PYT <- read.csv("20.GS.C4.PYT.80.SETA&SETB.CB.UB.csv")
UB.UYT30 <- read.csv("20.GS.C1.C2.C3.UYT.30.UB.csv")
UB.AYT40 <- read.csv("20.GS.C4B.AYT.40.UB.csv")
UB.AYT42 <- read.csv("20.GS.C4B.AYT.42.UB.csv")
UB.all <- rbind.fill(UB.UYT28, UB.PYT, UB.UYT30, UB.AYT40, UB.AYT42)
UBnames <- as.character(unique(UB.all$accession_name))
longnames <- read.csv("~/Desktop/Research/long-reads-list.csv")
DosageMatrix <- readRDS("~/Desktop/Research/Ubiaja_Trials/DosageMatrix_RefPanelAndGSprogeny_ReadyForGP_73019.rds")
# Subset for Chr 1
#grepl("S1", names(DosageMatrix[1,]) )
#DosMat1 <- DosageMatrix[grep("S1_", names(DosageMatrix[1,])) , ]
#grep("S1_", names(DosageMatrix[1,]))
# first 8307 observations:
DosMat1 <- DosageMatrix[,1:8307]
DosMatnames <- gsub(":.*","", rownames(DosMat1)) #remove genotyping code
DosMatnames1 <- gsub("_A.*","", DosMatnames) #remove DNA sample tag after _A
UBnames1 <- gsub("IITA-TMS-","", UBnames) #remove prefix in UBnames IITA samples
trueintsect <- grep(paste(UBnames1,collapse="|"), DosMatnames1, value=TRUE)
#write.csv(trueintsect,"~/Desktop/Research/Ubiaja_Trials/trueintersect.csv", row.names = FALSE)
# A better way to determine matches and mismatches
lengthUB <- length(UBnames1)
matchstore <- NA
mismatch <- NA
for (i in 1:lengthUB) {
maybematch <- grep(UBnames1[i], DosMatnames1)
if(length(maybematch) == 0){mismatch[i] <- UBnames[i]} else {matchstore[i] <- UBnames[i]}
}
UBmatches <- as.vector(na.omit(matchstore))
UBnotfound <- as.vector(na.omit(mismatch))
u_trueintsect <- read.csv("~/Desktop/Research/Ubiaja_Trials/unique_trueintersect.csv", header=FALSE)
u_trueintsect <- as.vector(u_trueintsect$V1)
#Add NASE14 which has long read data
u_trueintsect[89] <- "NASE14"
UBDosMat.names <- grep(paste(u_trueintsect,collapse="|"), rownames(DosMat1), value=TRUE)
UBDosMat <- subset(DosMat1, rownames(DosMat1) %in% UBDosMat.names)
#save(UBDosMat,file="UBDosMat.Rdata")
allIDMs <- read.csv("~/Desktop/Research/IDM_list.csv")
strictIDMs <- subset(allIDMs, IDMtype == "Strict")
strictIDMs1 <- subset(strictIDMs, Chr == 1)
IDMposlist <- as.vector(strictIDMs1$Pos)
IDMcolslist2 <- grep(paste(IDMposlist,collapse="|"), colnames(UBDosMat), value=TRUE)
UBDosdf <- data.frame(UBDosMat)
UBDosIDMs <- UBDosdf %>% select(any_of(IDMcolslist2))
#save(UBDosIDMs,file="UBDosMat.Rdata")
#shorten name
genos <- UBDosIDMs
IDMset <- strictIDMs1
IDMset <- IDMset %>% select(SNP, Pos, GlazAllele, AltAllele)
genosmelt <- melt(as.matrix(genos))
genosmeltS <- separate(genosmelt, Var2, into = c("Chr","Pos","Allele"), sep="_", remove = F, convert = TRUE)
genosmeltSIDM <- subset(genosmeltS, Pos %in% IDMset$Pos)
UBIDMDos <- left_join(genosmeltSIDM, IDMset, by = c("Pos"))
#saveRDS(UBIDMDos, file = "~/Desktop/Research/UBIDMDos.rds")
UBIDMstat <- UBIDMDos %>%
mutate(Status = ifelse(UBIDMDos$Allele == UBIDMDos$GlazAllele, "Glaz", "Esc"))
UBIDMstat$Status <- as.factor(UBIDMstat$Status)
UBIDMstat2 <- UBIDMstat %>%
mutate(dosvalue = ifelse(UBIDMstat$Status == "Glaz", UBIDMstat$value,
ifelse(UBIDMstat$Status == "Esc" & UBIDMstat$value == 0,2,
ifelse(UBIDMstat$Status == "Esc" & UBIDMstat$value == 2, 0,               ifelse(UBIDMstat$Status == "Esc" & UBIDMstat$value == 1, 1, NA)))))
UBstatussum <- aggregate(UBIDMstat2$dosvalue, by=list(accession=UBIDMstat2$Var1), FUN=mean, na.rm =TRUE)
UBstatussum <- UBstatussum %>% rename(mean.glazdose = x)
UBstatussum <- UBstatussum %>% arrange(mean.glazdose)
write.csv(UBstatussum, file = "~/Desktop/Research/UBclones_intro_summary.csv")
homoesclist <- c("TMS14F1284P0019", "TMS18F1161P0009", "TMS14F1036P0007", "TMS18F1302P0057", "IBA30572", "TMS18F1481P0075", "TMEB419_A19114", "TMS14F1310P0015", "TMS18F1298P0013", "IBA980581", "TMS15F1482P0098", "TMS18F1307P0038", "TMS14F1287P0008", "IBA980581", "TMS18F1310P0081")
KMatrix.homnames <- grep(paste(homoesclist,collapse="|"), rownames(KMatrix), value=TRUE)
library(hierfstat)
library(stats)
Kinship_IITA_SamplesForGP_73119 <- readRDS("~/Desktop/Research/Kinship_IITA_SamplesForGP_73119.rds")
KMatrix <- Kinship_IITA_SamplesForGP_73119
KMatrix.homnames <- grep(paste(homoesclist,collapse="|"), rownames(KMatrix), value=TRUE)
KMatrix.hometUB <- subset(KMatrix, rownames(KMatrix) %in% KMatrix.homnames)
KMatrix.hometUB <- KMatrix.hometUB[,colnames(KMatrix.hometUB) %in% KMatrix.homnames]
DistMat.hometUB <- kinship2dist(KMatrix.hometUB)
DistMat.hometUB[lower.tri(DistMat.hometUB)] <- 0
DistMatclusthome <- hclustfunc(DistMat.hometUB)
hclustfunc <- function(x, method = "complete", dmeth = "euclidean") {hclust(dist(x, method = dmeth), method = method)}
DistMatclusthome <- hclustfunc(DistMat.hometUB)
plot(DistMatclusthome, cex=0.5)
plot(DistMatclusthome, cex=0.5)
plot(DistMatclusthome, cex=0.5)
KMatrix.names <- grep(paste(hetlist,collapse="|"), rownames(KMatrix), value=TRUE)
hetlist <- c("TMS18F1481P0029", "TMS18F1108P0012", "TMS18F1269P0003", "TMS18F1163P0020", "TMS15F1279P0006", "TMS14F1285P0017", "TMS18F1331P0005", "TMS18F1419P0037", "TMS18F1175P0039", "TMS18F1286P0003", "TMS15F1329P0005", "TMS18F1275P0004", "TMS15F1100P0005", "TMS18F1033P0018", "TMS18F1339P0034", "TMS18F1159P0011", "TMS18F1272P0038", "TMS18F1562P0004", "TMS18F1481P0029", "TMS14F1285P0006", "TMS18F1539P0086", "TMS18F1298P0026", "TMS18F1299P0012", "TMS18F1327P0021")
KMatrix.names <- grep(paste(hetlist,collapse="|"), rownames(KMatrix), value=TRUE)
KMatrix.UB <- subset(KMatrix, rownames(KMatrix) %in% KMatrix.names)
KMatrix.UB <- KMatrix.UB[,colnames(KMatrix.UB) %in% KMatrix.names]
DistMat.UB <- kinship2dist(KMatrix.UB)
DistMat.UB[lower.tri(DistMat.UB)] <- 0
#DistMatclust <- hclust(DistMat.UB)
hclustfunc <- function(x, method = "complete", dmeth = "euclidean") {hclust(dist(x, method = dmeth), method = method)}
DistMatclust <- hclustfunc(DistMat.UB)
plot(DistMatclust, cex=0.5)
plot(DistMatclust, cex=0.5)
phenodata <- read.csv("~/Desktop/Research/2020-11-02T161432phenotype_download.csv")
u_trueintsect <- read.csv("~/Desktop/Research/Ubiaja_Trials/unique_trueintersect.csv", header=FALSE)
head(u_trueintsect)
setwd("~/Desktop/Research/Ubiaja_Trials")
UB.UYT28 <- read.csv("20.GS.C3.UYT.28.UB.csv")
UB.PYT <- read.csv("20.GS.C4.PYT.80.SETA&SETB.CB.UB.csv")
UB.UYT30 <- read.csv("20.GS.C1.C2.C3.UYT.30.UB.csv")
UB.AYT40 <- read.csv("20.GS.C4B.AYT.40.UB.csv")
UB.AYT42 <- read.csv("20.GS.C4B.AYT.42.UB.csv")
UB.all <- rbind.fill(UB.UYT28, UB.PYT, UB.UYT30, UB.AYT40, UB.AYT42)
UBnames <- as.character(unique(UB.all$accession_name))
UBnames1 <- gsub("IITA-TMS-","", UBnames) #remove prefix in UBnames IITA samples
namesintsct <- grep(paste(UBnames1,collapse="|"), phenodata$germplasmName, value=TRUE)
namesintsct
subphenos <- subset(phenodata, phenodata$germplasmName %in% namesintsct)
head(subphenos)
phenos <- subset(phenodata, phenodata$germplasmName %in% namesintsct)
colnames(phenos)
subphenos <- phenos[c(19,42,43,44,45,46,47,49,50)]
head(subphenos)
hist(subphenos$dry.matter.content.percentage.CO_334.0000092)
hist(subphenos$beta.carotene.content.ug.g.CO_334.0000095)
hist(subphenos$b.chromometer.value.CO_334.0002064)
hist(subphenos$total.carotenoid.by.chart.1.8.CO_334.0000161)
UBstatussum
read.csv(UBstatussum, file = "~/Desktop/Research/UBclones_intro_summary.csv")
UBstatussum1  <- read.csv("~/Desktop/Research/UBclones_intro_summary.csv")
head(UBstatussum1)
UBstatussum <- read.csv("~/Desktop/Research/UBclones_intro_summary.csv")
intstatsum <- UBstatussum
intstatsum$names <- gsub(":.*","", intstatsum$accession) #remove genotyping code
head(instatsum)
head(intstatsum)
intstatsum$names <- gsub("_A.*","", intstatsum$names) #remove DNA sample tag after _A
head(intstatsum)
intstatsum$names <- gsub("IITA-TMS-","", intstatsum$names)
head(intstatsum)
intstatsum$names <- gsub("IITA.TMS.","", intstatsum$names)
intstatsum$names
intstatsum$names <- gsub("*IITA.TMS.","", intstatsum$names)
intstatsum$names
intstatsum$names <- gsub("*...","", intstatsum$names)
intstatsum$names
intstatsum$names <- gsub(":.*","", intstatsum$accession) #remove genotyping code
intstatsum$names <- gsub("_A.*","", intstatsum$names) #remove DNA sample tag after _A
intstatsum$names <- gsub("IITA-TMS-","", intstatsum$names)
intstatsum$names
intstatsum$names <- gsub(".*\\.\\.\\.","", intstatsum$names)
intstatsum$names
intstatsum <- UBstatussum
intstatsum$names <- gsub(".*\\.\\.\\.","", intstatsum$names)
intstatsum$names <- gsub(".*\\.\\.\\.","", intstatsum$accession)
intstatsum$names
intstatsum$names <- gsub(":.*","", intstatsum$names) #remove genotyping code
intstatsum$names <- gsub("_A.*","", intstatsum$names) #remove DNA sample tag after _A
intstatsum$names <- gsub("IITA-TMS-","", intstatsum$names)
intstatsum$names <- gsub("IITA.TMS.","", intstatsum$names)
instatsum$names
intstatsum$names
head(intstatsum)
?aggregate()
?median
intstatsumag <- aggregate(intstatsum2$mean.glazdose, by=list(intstatsum$accession), FUN=median, na.rm =TRUE)
intstatsumag <- aggregate(intstatsum$mean.glazdose, by=list(intstatsum$accession), FUN=median, na.rm =TRUE)
head(intstatsumag)
intstatsum <- aggregate(intstatsum$mean.glazdose, by=list(intstatsum$accession), FUN=median, na.rm =TRUE)
colnames(intstatsum) <- c("accession","mean.glazdose")
head(intstatsumag)
intstatsum <- aggregate(intstatsum$mean.glazdose, by=list(intstatsum$accession), FUN=median, na.rm =TRUE) %>%
rename(accession = Group.1, mean.glazdose = x)
colnames(intstatsum) <- c("accession","mean.glazdose")
head(intstatsum)
intstatsum$names <- gsub(".*\\.\\.\\.","", intstatsum$accession) #remove everything before the "...""
intstatsum$names <- gsub(":.*","", intstatsum$names) #remove genotyping code
intstatsum$names <- gsub("_A.*","", intstatsum$names) #remove DNA sample tag after _A
intstatsum$names <- gsub("IITA-TMS-","", intstatsum$names)
intstatsum$names <- gsub("IITA.TMS.","", intstatsum$names)
?cbind
head(intstatsum)
head(subphenos$germplasmName)
grep(paste(intstatsum$names,collapse="|"), subphenos$germplasmName, value=TRUE)
phenos <- phenos[c(19,42,43,44,45,46,47,49,50)]
head(phenos)
library(dplyr)
head(phenos)
subphenos <- phenos[c(19,42,43,44,45,46,47,49,50)] %>%
group_by(germplasmName) %>%
summarise_each(funs(mean))
subphenos <- phenos[c(19,42,43,44,45,46,47,49,50)] %>%
group_by(phenos$germplasmName) %>%
summarise_each(funs(mean))
phenos <- subset(phenodata, phenodata$germplasmName %in% namesintsct)
subphenos <- phenos[c(19,42,43,44,45,46,47,49,50)] %>%
group_by(phenos$germplasmName) %>%
summarise_each(funs(mean))
phenoset <- phenos[c(19,42,43,44,45,46,47,49,50)]
subphenos <- aggregate(.~phenoset$germplasmName, phenoset, mean, na.rm=TRUE)
head(phenoset)
subphenos <- aggregate(.~phenoset$germplasmName, phenoset, mean)
subphenos <- aggregate(.~phenoset$germplasmName, phenoset, mean, na.action = na.omit)
subphenos <- aggregate(.~phenoset$germplasmName, phenoset, mean, na.rm=TRUE, na.action=NULL)
head(subphenos)
hist(subphenos$dry.matter.content.percentage.CO_334.0000092)
hist(subphenos$beta.carotene.content.ug.g.CO_334.0000095)
hist(subphenos$b.chromometer.value.CO_334.0002064)
hist(subphenos$total.carotenoid.by.chart.1.8.CO_334.0000161)
phenos <- subset(phenodata, phenodata$germplasmName %in% namesintsct)
phenoset <- phenos[c(19,42,43,44,45,46,47,49,50)]
subphenos <- aggregate(.~phenoset$germplasmName, phenoset, mean, na.rm=TRUE, na.action=NULL)
colnames(subphenos)
subphenos <- aggregate(.~phenoset$germplasmName="name", phenoset, mean, na.rm=TRUE, na.action=NULL)
subphenos <- aggregate(.~phenoset$germplasmName, phenoset, mean, na.rm=TRUE, na.action=NULL)
colnames(subphenos)
subphenos <- aggregate(.~phenoset$germplasmName, phenoset, mean, na.rm=TRUE, na.action=NULL) %>%
rename(accession = phenoset$germplasmName, numbered = germplasmName)
subphenos <- aggregate(.~phenoset$germplasmName, phenoset, mean, na.rm=TRUE, na.action=NULL) %>%
rename(accession = "phenoset$germplasmName", numbered = germplasmName)
colnames(subphenos)
subphenos$names <- gsub("IITA-TMS-","", subphenos$accession)
head(subphenos)
phenos_intstat <- merge(subphenos, intstatsum,by="names")
head(phenos_intstat)
phenos_intstat <- merge(subphenos, intstatsum$mean.glazdose, by="names")
head(intstatsum)
phenos_intstat <- merge(subphenos, intstatsum[, c("names","mean.glazdose")], by="names")
head(phenos_intstat)
intstatsum
intstatsum <- UBstatussum
intstatsum <- aggregate(intstatsum$mean.glazdose, by=list(intstatsum$accession), FUN=median, na.rm =TRUE) %>%
rename(accession = Group.1, mean.glazdose = x)
colnames(intstatsum) <- c("accession","mean.glazdose")
intstatsum
intstatsum$names <- gsub(".*\\.\\.\\.","", intstatsum$accession) #remove everything before the "...""
intstatsum$names <- gsub(":.*","", intstatsum$names) #remove genotyping code
intstatsum$names <- gsub("_A.*","", intstatsum$names) #remove DNA sample tag after _A
intstatsum$names <- gsub("IITA-TMS-","", intstatsum$names)
intstatsum$names <- gsub("IITA.TMS.","", intstatsum$names)
head(intstatsum)
intstatsum <- aggregate(intstatsum$mean.glazdose, by=list(intstatsum$names), FUN=median, na.rm =TRUE) %>%
rename(accession = Group.1, mean.glazdose = x)
intstatsum <- aggregate(intstatsum$mean.glazdose, by=list(intstatsum$names), FUN=median, na.rm =TRUE) %>%
head(intstatsum)
intstatsum
phenos_intstat <- merge(subphenos, intstatsum[, c("names","mean.glazdose")], by="names")
intstatsum <- UBstatussum
#Clean up list of names so it's compatible with the phenotype data
intstatsum$names <- gsub(".*\\.\\.\\.","", intstatsum$accession) #remove everything before the "...""
intstatsum$names <- gsub(":.*","", intstatsum$names) #remove genotyping code
intstatsum$names <- gsub("_A.*","", intstatsum$names) #remove DNA sample tag after _A
intstatsum$names <- gsub("IITA-TMS-","", intstatsum$names)
intstatsum$names <- gsub("IITA.TMS.","", intstatsum$names)
intstatsum <- aggregate(intstatsum$mean.glazdose, by=list(intstatsum$names), FUN=median, na.rm =TRUE) %>%
rename(names = Group.1, mean.glazdose = x)
phenos_intstat <- merge(subphenos, intstatsum[, c("names","mean.glazdose")], by="names")
head(phenos_intstat)
head(phenos_intstat[,4]
)
plot(phenos_intstat$mean.glazdose, phenos_intstat[,4]) #chromameter b value
plot(phenos_intstat$mean.glazdose, phenos_intstat[,4], main="Chromameter b value") #chromameter b valu
colnames(phenos_intstat)
plot(phenos_intstat$mean.glazdose, phenos_intstat[,10]) #total carotenoid by chart
plot(phenos_intstat$mean.glazdose, phenos_intstat[,4], xlab="mean glaz dose", ylab="chromameter b value") #
plot(phenos_intstat$mean.glazdose, phenos_intstat[,10], xlab="mean glaz dose", ylab="total carotenoid by chart") #total carotenoid by chart
phenos_intstat[,10]
range(phenos_intstat[,10])
subphenos$total.carotenoid.by.chart.1.8.CO_334.0000161
phenos_intstat[,10]
range(phenos_intstat[,10])
range(phenos_intstat$total.carotenoid.by.chart.1.8.CO_334.0000161)
range(phenos$total.carotenoid.by.chart.1.8.CO_334.0000161)
range(subphenos$total.carotenoid.by.chart.1.8.CO_334.0000161)
phenos_intstat <- merge(subphenos, intstatsum[, c("names","mean.glazdose")], by="names")
range(phenos_intstat$total.carotenoid.by.chart.1.8.CO_334.0000161)
subphenos
grep("IBA070593", intstatsum$names, value=TRUE)
grep("IBA141092", intstatsum$names, value=TRUE)
grep("IBA000070", intstatsum$names, value=TRUE)
phenos_intstat <- merge(subphenos, intstatsum[, c("names","mean.glazdose")], by="names", all=TRUE)
#Note: this merge drops some accessions that don't match between both names sets
#high carotenoids: IBA070593, IBA141092
grep("IBA141092", intstatsum$names, value=TRUE)
grep("IBA141092", phenos_intstat$names, value=TRUE)
head(phenos_intstat)
plot(phenos_intstat$mean.glazdose, phenos_intstat[,4], xlab="mean glaz dose", ylab="chromameter b value") #chromameter b value
plot(phenos_intstat$mean.glazdose, phenos_intstat[,10], xlab="mean glaz dose", ylab="total carotenoid by chart") #total carotenoid by chart
colnames(phenos_intstat)
plot(phenos_intstat$mean.glazdose, phenos_intstat[,9], xlab="mean glaz dose", ylab="root number") #root number
library(Hmisc)
rcorr(as.matrix(phenos_intstat))
?rcorr
is.na(phenos_intstat)
rcorr(na.omit(as.matrix(phenos_intstat)))
cor(as.matrix(phenos_intstat), use = "pairwise.complete.obs")
?cor
as.matrix(phenos_intstat)
rcorr(as.matrix(phenos_intstat))
phenos_intstat <- phenos_intstat[which(is.nan(phenos_intstat))] = NA
phenos_intstat[which(is.nan(phenos_intstat))] = NA
is.nan(phenos_intstat)
head(phenos_intstat, n=50)
NA <- phenos_intstat[which(is.nan(phenos_intstat[,]))]
phenos_intstat[which(is.nan(phenos_intstat[,]))] <- NA
colnames(phenos_intstat)
phenos_intstat[which(is.nan(phenos_intstat[,4:12]))] <- NA
is.nan(phenos_intstat[, 4])
is.nan(phenos_intstat[, 4:5])
is.nan(phenos_intstat[, 5])
phenos_intstat[ is.na(phenos_intstat) ] <- NA
rcorr(as.matrix(phenos_intstat))
head(phenos_intstat, n=50)
testdf <- phenos_intstat[-9,]
testdf
phenos_intstat1 <- phenos_intstat[-9,]
rcorr(as.matrix(phenos_intstat1), na.rm=TRUE)
rcorr(as.matrix(phenos_intstat1))
colnames(phenos_intstat1)
rcorr(as.matrix(phenos_intstat1[,4:12]))
plot(phenos_intstat$mean.glazdose, phenos_intstat[,10], xlab="mean glaz dose", ylab="total carotenoid by chart") #
range(phenos_intstat[,10])
phenos_intstat[,10]
range(phenos_intstat[,10])
range(phenos_intstat$total.carotenoid.by.chart.1.8.CO_334.0000161)
?range
phenos$total.carotenoid.by.chart.1.8.CO_334.0000161
range(phenos$total.carotenoid.by.chart.1.8.CO_334.0000161)
range(phenos$total.carotenoid.by.chart.1.8.CO_334.0000161, na.rm=TRUE)
subphenos$total.carotenoid.by.chart.1.8.CO_334.0000161
range(subphenos$total.carotenoid.by.chart.1.8.CO_334.0000161)
range(phenos_instat$total.carotenoid.by.chart.1.8.CO_334.0000161, na.rm=TRUE)
range(phenosinstat$total.carotenoid.by.chart.1.8.CO_334.0000161, na.rm=TRUE)
range(phenos_intstat$total.carotenoid.by.chart.1.8.CO_334.0000161, na.rm=TRUE)
range(phenos_intstat[,10], na.rm=TRUE)
plot(phenos_intstat$mean.glazdose, phenos_intstat[,10], xlab="mean glaz dose", ylab="total carotenoid by chart") #total carotenoid by chart
length(subphenos$accession)
length(phenoset$germplasmName)
length(UBnames1)
plot(phenos_intstat$mean.glazdose, phenos_intstat[,4], xlab="mean glaz dose", ylab="chromameter b value") #chromameter b value
plot(phenos_intstat$mean.glazdose, phenos_intstat[,10], xlab="mean glaz dose", ylab="total carotenoid by chart") #total carotenoid by chart
plot(phenos_intstat$mean.glazdose, phenos_intstat[,9], xlab="mean glaz dose", ylab="root number") #root number
plot(phenos_intstat$mean.glazdose, phenos_intstat[,10], xlab="mean glaz dose", ylab="total carotenoid by chart") #total carotenoid by chart
knitr::opts_chunk$set(echo = TRUE)
longnames <- read.csv("~/Desktop/Research/long-reads-list.csv")
head(longnames)
head(longnames$Long.names)
longnames$Long.names
intrsummary <- read.csv("~/Desktop/Research/UBclones_intro_summary.csv")
head(intrsummary)
grep(longnames$Long.names, intrsummary$accession)
library(tidyverse)
longnames$Long.names %>%in%>% intrsummary$accession
longnames$Long.names %in% intrsummary$accession
longnames$Long.names %>% grep( , intrsummary$accession)
longnames$Long.names %>% grep(intrsummary$accession)
long.names <- longnames$Long.names
grep(long.names[1], intrsummary$accession)
grep(long.names[2], intrsummary$accession)
grep(long.names[5], intrsummary$accession)
grep(long.names[6], intrsummary$accession)
for(i in 1:length(long.names)){
line <- grep(long.names[i], intrsummary$accession)
print(intrsummary[line,])
}
line
intrsummary[1,]
intrsummary[2,]
intrsummary[3,]
for(i in 1:length(long.names)){
line <- grep(long.names[i], intrsummary$accession)
if(line != 0) {print(intrsummary[line,])}
}
line != 0
line <- grep(long.names[6], intrsummary$accession)
line
if(line != 0) { print(intrsummary[line,]) }
line <- grep(long.names[1], intrsummary$accession)
line
is.na(line)
is.numeric(line)
if(line != 0) { print(intrsummary[line,]) }
if (line == integer(0)){print("yes")}
for(i in 1:length(long.names)){
line <- grep(long.names[i], intrsummary$accession)
print(intrsummary[line,])
#if(line != 0) {}
}
for(i in 1:length(long.names)){
line <- grep(long.names[i], intrsummary$accession)
print(c(i, intrsummary[line,]))
#if(line != 0) {}
}
for(i in 1:length(long.names)){
line <- grep(long.names[i], intrsummary$accession)
print(c(i, intrsummary[line, accession]))
#if(line != 0) {}
}
grepl(long.names[i], intrsummary$accession)
for(i in 1:length(long.names)){
lines <- grepl(long.names[i], intrsummary$accession)
print(intrsummary[lines,])
}
long.names
longnames
