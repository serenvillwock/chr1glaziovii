library(dplyr)
parent.clusters.10kasp = subset(parent.clusters, kasp %in% kasp.selection)
totalglaz = aggregate(as.numeric(mean.glazdose) ~ parent, FUN=mean, data=parent.clusters.10kasp)
colnames(totalglaz) = c("parent","totalglz")
parent.clusters.10kasp.tosort = join(parent.clusters.10kasp, totalglaz, by="parent", type="left")
library(plyr)
parent.clusters.10kasp = subset(parent.clusters, kasp %in% kasp.selection)
totalglaz = aggregate(as.numeric(mean.glazdose) ~ parent, FUN=mean, data=parent.clusters.10kasp)
colnames(totalglaz) = c("parent","totalglz")
parent.clusters.10kasp.tosort = join(parent.clusters.10kasp, totalglaz, by="parent", type="left")
parent.clusters.10kasp.sorted = parent.clusters.10kasp.tosort[order(parent.clusters.10kasp.tosort$totalglz),]
tiff("~/Desktop/Research/Glaziovii_introgression/KASP_design/Verification_05-2021/UBparents_intro_status_by_KASP_selected10", units="px", width=2500, height=1600, res=300)
ggplot(data = parent.clusters.10kasp.sorted) +
geom_point(aes(x=as.numeric(kasp), y=parent, color=cluster)) +
scale_color_manual(values=c("#FFFFFF", "#FF9900", "#0066FF", "gray95", "#FFCC66")) +
scale_x_continuous(name="Chromosome 1 Mbp")
dev.off()
library(tidyverse)
setwd("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/")
height = read.csv("Data_backup/plant-height_master_fieldbook_layout_2021-06-29_13_29_45_21.GS.C6.SN.Student2.IB_table.csv")[, c(1,2,3,4,13,21)]
height[1145,5] <- NA # remove outlier value -- need to re-measure this plant
untagged = read.csv("Data_backup/missing_21.GS.C6.SN.Student2.IB.csv")[, c(3,10)]
smith = read.csv("Data_backup/smith_june_data.csv")[,c(3,5,9,10,11)]
living = height[!is.na(height[,5]),]
nrow(height[!is.na(height[,5]),]) + nrow(untagged) #5031 living plants with height values
#3008 - 52 parents = 2956 to sample from the population (about 59% of the population)
all = merge(height,smith, by=c("accession_name","plot_number"))
hist(height$plant.height.measurement.in.cm....CO_334.0000018, breaks=20, main="plant height variation", xlab="plant height in cm")
require("readxl")
require("tidyverse")
setwd("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Tissue_sampling/")
file_list <- list.files(path="~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Tissue_sampling/", full.names=FALSE)
all_plates <- data.frame()
for (i in 1:length(file_list)){
temp_data <- read.csv(file_list[i])
all_plates <- rbind(all_plates, temp_data)
}
all_plates$plate_id = sub("(?i)plate ", "plate_", all_plates$plate_id) #fix spaces and case
all_plates$plate_name = gsub(" ", "_", all_plates$plate_name)
layout = read.csv("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Nursery_layouts_barcodes/Seren_SN/Layouts/21.GS.C6.SN.Student2.IB_layout_old.csv")[,1:3]
layout$plot_number = as.character(layout$plot_number)
missing.key = read.csv("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Nursery_layouts_barcodes/Seren_SN/Layouts/missing_21.GS.C6.SN.Student2.IB_table_updated-names.csv")
#make a column for the type of name listed as the tissue ID
all_plates$name_type[grepl("^TMS", all_plates$tissue_id)] = "acc.name"
all_plates$name_type[grepl("^21.GS.C6", all_plates$tissue_id)] = "full.name"
all_plates$name_type[grepl("^([0-9])+$", all_plates$tissue_id)] = "plot.num"
all_plates$name_type[grepl("BLANK", all_plates$tissue_id)] = "blank"
all_plates$name_type[c(2975,3065:3069)] = "full.name" #manually set wilds
#for each name type, find the associated full name and put it in a new column
for(i in 1:nrow(all_plates)){
#look up by plot number; find associated full accession name
if(all_plates$name_type[i] == "plot.num"){
lookup = layout$plot_name[grep(paste0("^",all_plates$tissue_id[i],"$"), layout$plot_number)]
if(length(lookup)!=0){
all_plates$full_name[i] <- lookup
} else{
all_plates$full_name[i] <- all_plates$tissue_id[i]
#print(paste0("error at ",i))
}
}
#look up by accession name; fix the name if it's from the missing plants layout
#the "missing" tag is also added to the parents (since they are not in main layout)
if(all_plates$name_type[i] == "acc.name"){
lookup = grep(all_plates$tissue_id[i], layout$plot_name, value=TRUE)
if(length(lookup)!=0){
all_plates$full_name[i] <- lookup
} else{
#check if it's in the missing names key
lookup2 = grep(all_plates$tissue_id[i], missing.key$accession_name_old, value=F)
if(length(lookup2)!=0){
all_plates$full_name[i] <-
paste0("21.GS.C6.SN.Student2.IB.missing-", missing.key$accession_name_new[lookup2]) }
else{
all_plates$full_name[i] <- paste0("21.GS.C6.SN.Student2.IB.missing-",
all_plates$tissue_id[i])}
}
}
#leave it if it's already the full name or if it's a blank well
if(all_plates$name_type[i] == "full.name" | all_plates$name_type[i] == "blank"){
all_plates$full_name[i] <- all_plates$tissue_id[i]
}
}
#rename the tissue_id as the full accession name and save for exporting
all_plates_export = all_plates
all_plates_export$tissue_id <- all_plates_export$full_name
setwd("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/")
write.csv(all_plates_export[,1:11], "21.GS.C6.SN.Student2_plate_coordinates.csv")
layout = read.csv("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Nursery_layouts_barcodes/Seren_SN/Layouts/21.GS.C6.SN.Student2.IB_layout_old.csv")[,1:3]
layout$plot_number = as.character(layout$plot_number)
missing.key = read.csv("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Nursery_layouts_barcodes/Seren_SN/Layouts/missing_21.GS.C6.SN.Student2.IB_table_updated-names.csv")
#make a column for the type of name listed as the tissue ID
all_plates$name_type[grepl("^TMS", all_plates$tissue_id)] = "acc.name"
all_plates$name_type[grepl("^21.GS.C6", all_plates$tissue_id)] = "full.name"
all_plates$name_type[grepl("^([0-9])+$", all_plates$tissue_id)] = "plot.num"
all_plates$name_type[grepl("BLANK", all_plates$tissue_id)] = "blank"
all_plates$name_type[c(2975,3065:3069)] = "full.name" #manually set wilds
#for each name type, find the associated full name and put it in a new column
for(i in 1:nrow(all_plates)){
#look up by plot number; find associated full accession name
if(all_plates$name_type[i] == "plot.num"){
lookup = layout$plot_name[grep(paste0("^",all_plates$tissue_id[i],"$"), layout$plot_number)]
if(length(lookup)!=0){
all_plates$full_name[i] <- lookup
} else{
all_plates$full_name[i] <- all_plates$tissue_id[i]
#print(paste0("error at ",i))
}
}
#look up by accession name; fix the name if it's from the missing plants layout
#the "missing" tag is also added to the parents (since they are not in main layout)
if(all_plates$name_type[i] == "acc.name"){
lookup = grep(all_plates$tissue_id[i], layout$plot_name, value=TRUE)
if(length(lookup)!=0){
all_plates$full_name[i] <- lookup
} else{
#check if it's in the missing names key
lookup2 = grep(all_plates$tissue_id[i], missing.key$accession_name_old, value=F)
if(length(lookup2)!=0){
all_plates$full_name[i] <-
paste0("21.GS.C6.SN.Student2.IB.missing-", missing.key$accession_name_new[lookup2]) }
else{
all_plates$full_name[i] <- paste0("21.GS.C6.SN.Student2.IB-plantM-",
all_plates$tissue_id[i])}
}
}
#leave it if it's already the full name or if it's a blank well
if(all_plates$name_type[i] == "full.name" | all_plates$name_type[i] == "blank"){
all_plates$full_name[i] <- all_plates$tissue_id[i]
}
}
#rename the tissue_id as the full accession name and save for exporting
all_plates_export = all_plates
all_plates_export$tissue_id <- all_plates_export$full_name
setwd("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/")
write.csv(all_plates_export[,1:11], "21.GS.C6.SN.Student2_plate_coordinates.csv")
layout = read.csv("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Nursery_layouts_barcodes/Seren_SN/Layouts/21.GS.C6.SN.Student2.IB_layout_old.csv")[,1:3]
layout$plot_number = as.character(layout$plot_number)
missing.key = read.csv("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Nursery_layouts_barcodes/Seren_SN/Layouts/missing_21.GS.C6.SN.Student2.IB_table_updated-names.csv")
#make a column for the type of name listed as the tissue ID
all_plates$name_type[grepl("^TMS", all_plates$tissue_id)] = "acc.name"
all_plates$name_type[grepl("^21.GS.C6", all_plates$tissue_id)] = "full.name"
all_plates$name_type[grepl("^([0-9])+$", all_plates$tissue_id)] = "plot.num"
all_plates$name_type[grepl("BLANK", all_plates$tissue_id)] = "blank"
all_plates$name_type[c(2975,3065:3069)] = "full.name" #manually set wilds
#for each name type, find the associated full name and put it in a new column
for(i in 1:nrow(all_plates)){
#look up by plot number; find associated full accession name
if(all_plates$name_type[i] == "plot.num"){
lookup = layout$plot_name[grep(paste0("^",all_plates$tissue_id[i],"$"), layout$plot_number)]
if(length(lookup)!=0){
all_plates$full_name[i] <- lookup
} else{
all_plates$full_name[i] <- all_plates$tissue_id[i]
#print(paste0("error at ",i))
}
}
#look up by accession name; fix the name if it's from the missing plants layout
#the "missing" tag is also added to the parents (since they are not in main layout)
if(all_plates$name_type[i] == "acc.name"){
lookup = grep(all_plates$tissue_id[i], layout$plot_name, value=TRUE)
if(length(lookup)!=0){
all_plates$full_name[i] <- lookup
} else{
#check if it's in the missing names key
lookup2 = grep(all_plates$tissue_id[i], missing.key$accession_name_old, value=F)
if(length(lookup2)!=0){
all_plates$full_name[i] <-
paste0("21.GS.C6.SN.Student2.IB-plantM-", missing.key$accession_name_new[lookup2]) }
else{
all_plates$full_name[i] <- paste0("21.GS.C6.SN.Student2.IB-plantM-",
all_plates$tissue_id[i])}
}
}
#leave it if it's already the full name or if it's a blank well
if(all_plates$name_type[i] == "full.name" | all_plates$name_type[i] == "blank"){
all_plates$full_name[i] <- all_plates$tissue_id[i]
}
}
#rename the tissue_id as the full accession name and save for exporting
all_plates_export = all_plates
all_plates_export$tissue_id <- all_plates_export$full_name
setwd("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/")
write.csv(all_plates_export[,1:11], "21.GS.C6.SN.Student2_plate_coordinates.csv")
#x is sprinkler.row, y is position
library(ggplot2)
stems$megablock = NA
setwd("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Data_backup/")
stems = read.csv("stem-diameter-master_2021-07-28-08-24-12_21.GS.C6.SN.Student2.IB_layout_old_table.csv")
stems$megablock = NA
stems$megablock[stems$Block == 1 | stems$Block == 2 | stems$Block == 3  | stems$Block == 4] <- 1
stems$megablock[stems$Block == 5 | stems$Block == 6] <- 2
stems$unique.row = paste0(stems$Block, "_", stems$sprinkler.row)
stems$plantnum = ave(stems$plot_number, stems$unique.row, FUN = seq_along) # need to orient backwards and forwards
#maximum number of plants in a row
stems$position = NA
for(i in 1:length(unique(stems$unique.row))){
this.row = stems[stems$unique.row == unique(stems$unique.row)[i],]
n.plants.this.row = nrow(this.row)
if(this.row$direction[1] == "up"){ #up is toward corn, down is towards road
stems$position[stems$unique.row == unique(stems$unique.row)[i]] <- seq(1, n.plants.this.row)
} else if(this.row$direction[1] == "down"){
stems$position[stems$unique.row == unique(stems$unique.row)[i]] <- seq(n.plants.this.row, 1)
}
}
#x is sprinkler.row, y is position
library(ggplot2)
test.stems = stems[stems$Block == 1,]
test <- data.frame(test.stems$sprinkler.row, test.stems$position, test.stems$Basal_stem_diameter_mm)
head(test.stems)
ggplot(data=test.stems, aes(unique.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile()
stems$megablock = NA
stems$megablock[stems$Block == 1 | stems$Block == 2 | stems$Block == 3  | stems$Block == 4] <- 1
stems$megablock[stems$Block == 5 | stems$Block == 6] <- 2
stems$unique.row = paste0(stems$Block, "_", stems$sprinkler.row)
stems$plantnum = ave(stems$plot_number, stems$unique.row, FUN = seq_along) # need to orient backwards and forwards
#maximum number of plants in a row
stems$position = NA
for(i in 1:length(unique(stems$unique.row))){
this.row = stems[stems$unique.row == unique(stems$unique.row)[i],]
n.plants.this.row = nrow(this.row)
if(this.row$direction[1] == "up"){ #up is toward corn, down is towards road
stems$position[stems$unique.row == unique(stems$unique.row)[i]] <- seq(1, n.plants.this.row)
} else if(this.row$direction[1] == "down"){
stems$position[stems$unique.row == unique(stems$unique.row)[i]] <- seq(n.plants.this.row, 1)
}
}
#x is sprinkler.row, y is position
library(ggplot2)
test.stems = stems[stems$Block == 1,]
test <- data.frame(test.stems$sprinkler.row, test.stems$position, test.stems$Basal_stem_diameter_mm)
ggplot(data=test.stems, aes(unique.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
theme(legend.position="none")
ggplot(data=test.stems, aes(unique.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
#    theme_ipsum() +
theme(legend.position="none")
ggplot(data=test.stems, aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
#    theme_ipsum() +
theme(legend.position="none")
library(hrbrthemes)
install.packages("hrbrthemes")
ggplot(data=test.stems, aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
theme(legend.position="none")
library(hrbrthemes)
ggplot(data=test.stems, aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
theme(legend.position="none")
hrbrthemes::import_roboto_condensed()
library(hrbrthemes)
ggplot(data=test.stems, aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
theme(legend.position="none")
ggplot(data=test.stems, aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=test.stems, aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
scale_fill_viridis() +
theme(legend.position="none")
class(test.stems$Basal_stem_diameter_mm)
test.stems$Basal_stem_diameter_mm = as.numeric(test.stems$Basal_stem_diameter_mm)
ggplot(data=test.stems, aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
height = read.csv("plant-height_master_fieldbook_layout_2021-06-29_13_29_45_21.GS.C6.SN.Student2.IB_table.csv")[, c(1,2,3,4,13,21)]
setwd("~/Desktop/Research/Glaziovii_introgression/IITA_data_collection_seedling_nursery_2021/Data_backup/")
stems = read.csv("stem-diameter-master_2021-07-28-08-24-12_21.GS.C6.SN.Student2.IB_layout_old_table.csv")
height = read.csv("plant-height_master_fieldbook_layout_2021-06-29_13_29_45_21.GS.C6.SN.Student2.IB_table.csv")[, c(1,2,3,4,13,21)]
head(height)
colnames(height)[5] = "height"
head(height)
stems$megablock = NA
stems$megablock[stems$Block == 1 | stems$Block == 2 | stems$Block == 3  | stems$Block == 4] <- 1
stems$megablock[stems$Block == 5 | stems$Block == 6] <- 2
stems$unique.row = paste0(stems$Block, "_", stems$sprinkler.row)
stems$plantnum = ave(stems$plot_number, stems$unique.row, FUN = seq_along) # need to orient backwards and forwards
#maximum number of plants in a row
stems$position = NA
for(i in 1:length(unique(stems$unique.row))){
this.row = stems[stems$unique.row == unique(stems$unique.row)[i],]
n.plants.this.row = nrow(this.row)
if(this.row$direction[1] == "up"){ #up is toward corn, down is towards road
stems$position[stems$unique.row == unique(stems$unique.row)[i]] <- seq(1, n.plants.this.row)
} else if(this.row$direction[1] == "down"){
stems$position[stems$unique.row == unique(stems$unique.row)[i]] <- seq(n.plants.this.row, 1)
}
}
head(stems)
?join()
?merge()
pheno.master = merge(stems, height, by="plot_name")
head(pheno.master)
head(height)
head(stems)
pheno.master = merge(stems, height, by="plot_number")
head(pheno.master)
pheno.master = merge(stems, height, by=c("plot_number", "plot_name", "accession_name"))
head(pheno.master)
pheno.master = merge(stems, height, by=c("plot_number", "accession_name"))
head(pheno.master)
class(stems$plot_number)
class(height$plot_number)
head(stems)
head(height)
?join()
pheno.master = inner_join(stems, height, by=c("plot_number", "accession_name"))
library(tidyverse)
pheno.master = inner_join(stems, height, by=c("plot_number", "accession_name"))
head(pheno.master)
test.stems = pheno.master[pheno.master$Block == 1,]
test <- data.frame(test.stems$sprinkler.row, test.stems$position, test.stems$height)
test.stems$height = as.numeric(test.stems$height)
ggplot(data=test.stems, aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master, aes(unique.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
head(pheno.master)
for(i in 1:length(unique(stems$unique.row))){
this.row = stems[stems$unique.row == unique(stems$unique.row)[i],]
n.plants.this.row = nrow(this.row)
stems$position[stems$unique.row == unique(stems$unique.row)[i]] <- seq(1, n.plants.this.row)
}
pheno.master = inner_join(stems, height, by=c("plot_number", "accession_name"))
ggplot(data=pheno.master, aes(unique.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
hist(pheno.master$height)
height[1145,5] <- NA # remove outlier value
pheno.master = inner_join(stems, height, by=c("plot_number", "accession_name"))
ggplot(data=pheno.master, aes(unique.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master, aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master, aes(unique.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master[pheno.master$Block == 2,], aes(unique.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master[pheno.master$Block == 2,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
head(pheno.master)
ggplot(data=pheno.master[pheno.master$Block == 2,], aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
pheno.master$Basal_stem_diameter_mm = as.numeric(pheno.master$Basal_stem_diameter_mm)
ggplot(data=pheno.master[pheno.master$Block == 2,], aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master[pheno.master$Block == 3,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master[pheno.master$Block == 4,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master[pheno.master$Block == 5,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master[pheno.master$Block == 3,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue") +
theme(legend.position="none")
ggplot(data=pheno.master[pheno.master$Block == 3,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="blue")
ggplot(data=pheno.master[pheno.master$Block == 3,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="light green", high="dark green")
ggplot(data=pheno.master[pheno.master$Block == 3,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="dark green")
ggplot(data=pheno.master[pheno.master$Block == 3,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(trans="log", low="white", high="dark green")
ggplot(data=pheno.master[pheno.master$Block == 3,], aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="dark green")
tograph = pheno.master[pheno.master$Block == 3 & !is.na(pheno.master$height),]
head(tograph)
ggplot(data=tograph, aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="dark green")
for(i in 1:length(unique(stems$unique.row))){
this.row = stems[stems$unique.row == unique(stems$unique.row)[i] & !is.na(stems$Basal_stem_diameter_mm),]
n.plants.this.row = nrow(this.row)
stems$position[stems$unique.row == unique(stems$unique.row)[i]] <- seq(1, n.plants.this.row)
}
this.row = stems[stems$unique.row == unique(stems$unique.row)[1] & !is.na(stems$Basal_stem_diameter_mm),]
head(this.row)
n.plants.this.row = nrow(this.row)
n.plants.this.row
seq(1, n.plants.this.row)
for(i in 1:length(unique(stems$unique.row))){
this.row = stems[stems$unique.row == unique(stems$unique.row)[i] & !is.na(stems$Basal_stem_diameter_mm),]
n.plants.this.row = nrow(this.row)
stems$position[stems$unique.row == unique(stems$unique.row)[i] & !is.na(stems$Basal_stem_diameter_mm),] <- seq(1, n.plants.this.row)
}
for(i in 1:length(unique(stems$unique.row))){
this.row = stems[stems$unique.row == unique(stems$unique.row)[i] & !is.na(stems$Basal_stem_diameter_mm),]
n.plants.this.row = nrow(this.row)
stems$position[stems$unique.row == unique(stems$unique.row)[i] & !is.na(stems$Basal_stem_diameter_mm)] <- seq(1, n.plants.this.row)
}
pheno.master = inner_join(stems, height, by=c("plot_number", "accession_name"))
tograph = pheno.master[pheno.master$Block == 3 & !is.na(pheno.master$height),]
ggplot(data=tograph, aes(sprinkler.row, position, fill= height)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="dark green")
head(stems$position)
head(stems$position, n=200)
ggplot(data=tograph, aes(sprinkler.row, position, fill= Basal_stem_diameter_mm)) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="dark blue")
ggplot(data=tograph, aes(sprinkler.row, position, fill= as.numeric(Basal_stem_diameter_mm))) +
geom_tile() +
theme_ipsum() +
scale_fill_gradient(low="white", high="dark blue")
getwd()
getwd()
setwd("~/Desktop/Research/Glaziovii_introgression/KASP_design/uplift_v6_v7/uplift_markers/")
markers = read.csv("all_markers.csv")
head(markers)
library(tidyverse)
?str_split()
head(str_split(markers$GBSSNPID, pattern="_"))
?separate()
markers = separate(markers, col=GBSSNPID, sep="_", into= c("CHROM_S", "POS"))
head(markers)
markers = separate(markers, col=GBSSNPID, sep="_", into= c("CHROM_S", "POS"), remove=FALSE)
markers = read.csv("all_markers.csv")
markers = separate(markers, col=GBSSNPID, sep="_", into= c("CHROM_S", "POS"), remove=FALSE)
head(markers)
?str_replace
markers$CHROM = str_replace(markers$CHROM_S, "S", "")
head(markers)
?select()
markers = markers %>% select(CHROM, POS, GBSSNPID,  INTERTEK_SNP_ID, TYPE)
head(markers)
markers = read.csv("all_markers.csv")
markers = separate(markers, col=GBSSNPID, sep="_", into= c("CHROM_S", "POS"), remove=FALSE)
markers$CHROM = str_replace(markers$CHROM_S, "S", "")
markers = markers %>% select(GBSSNPID, CHROM, POS,  INTERTEK_SNP_ID, TYPE)
head(markers)
tail(markers)
markers = read.csv("all_markers.csv")
markers = separate(markers, col=GBSSNPID, sep="_", into= c("CHROM_S", "POS"), remove=FALSE)
markers$CHROM = str_replace(markers$CHROM_S, "S", "")
markers = markers %>% select(GBSSNPID, CHROM, POS,  INTERTEK_SNP_ID, TYPE)
tail(markers)
tail(markers, n=50)
head(markers, n=50)
write.csv(markers, file="all_markers_to-uplift.csv")
?write.csv()
write.csv(markers, file="all_markers_to-uplift.csv", col.names=FALSE)
markers = read.csv("all_markers.csv")
markers = separate(markers, col=GBSSNPID, sep="_", into= c("CHROM_S", "POS"), remove=FALSE)
markers$CHROM = str_replace(markers$CHROM_S, "S", "")
markers = markers %>% select(GBSSNPID, CHROM, POS,  INTERTEK_SNP_ID, TYPE)
write.csv(markers, file="all_markers_to-uplift.csv", col.names=FALSE)
write.csv(markers, file="all_markers_to-uplift.csv")
